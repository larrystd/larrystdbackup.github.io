<!DOCTYPE html><html lang="zh-CN"><head><!-- hexo injector head_begin start --><link href="/css/tag-common/index.css" rel="stylesheet"/><!-- hexo injector head_begin end --><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#6200ee"><meta name="author" content="larry"><meta name="copyright" content="larry"><meta name="generator" content="Hexo 5.4.0"><meta name="theme" content="hexo-theme-yun"><title>å¸¸ç”¨ç±»å®ç° shared_ptr skip_list heap | æ‹‰ç‘å›ã®å°çª</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.25/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_dxory92pb0h.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link class="aplayer-style-marker" rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.css"><script class="aplayer-script-marker" src="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.js" defer></script><script class="meting-script-marker" src="https://cdn.jsdelivr.net/npm/meting@1/dist/Meting.min.js" defer></script><script>document.addEventListener(
  "pjax:success",
  function() {
    if (window.aplayers) {
      loadMeting();
    }
  },
  !1
);
</script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><link rel="icon" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#6200ee"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"larrystd.github.io","root":"/","title":"æ‹‰ç‘å›ã®å°çª","version":"1.6.3","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"æœç´¢...","empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹: ${query}","hits":"æ‰¾åˆ° ${hits} æ¡ç»“æœ","hits_time":"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"algolia":{"appID":"CJXXAGRCYN","apiKey":"ae1966d2aeab22bf9335679f45d2cd9a","indexName":"my-hexo-blog","hits":{"per_page":8}},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><link rel="alternate" href="/atom.xml" title="æ‹‰ç‘å›ã®å°çª" type="application/atom+xml"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=G-1LL0D86CY9"></script><script>if (CONFIG.hostname === location.hostname) {
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-1LL0D86CY9');
}</script><script data-ad-client="ca-pub-2245427233262012" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-M9KWR9L');</script><!-- End Google Tag Manager --><meta name="description" content="ä¼šç”¨åªæ˜¯çš®æ¯›, éœ€è¦å¯¹å¸¸ç”¨ç±»è¿›è¡Œç®€å•å®ç°, ä¾‹å¦‚shared_ptr, mutexç­‰  shared_ptr æ ¸å¿ƒ, threadåŠ é”, å¯¹è±¡è®¡æ•°, å°è£…çš„åŸå§‹æŒ‡é’ˆ  é‡è½½operator*, operator-&gt;æ“ä½œç¬¦  å®ç°release()ï¼Œ reset()">
<meta property="og:type" content="article">
<meta property="og:title" content="å¸¸ç”¨ç±»å®ç° shared_ptr skip_list heap">
<meta property="og:url" content="https://larrystd.github.io/cpp%E8%BF%9B%E9%98%B6/2021-09-25-%E5%B8%B8%E7%94%A8%E7%B1%BB%E7%9A%84%E5%AE%9E%E7%8E%B0/index.html">
<meta property="og:site_name" content="æ‹‰ç‘å›ã®å°çª">
<meta property="og:description" content="ä¼šç”¨åªæ˜¯çš®æ¯›, éœ€è¦å¯¹å¸¸ç”¨ç±»è¿›è¡Œç®€å•å®ç°, ä¾‹å¦‚shared_ptr, mutexç­‰  shared_ptr æ ¸å¿ƒ, threadåŠ é”, å¯¹è±¡è®¡æ•°, å°è£…çš„åŸå§‹æŒ‡é’ˆ  é‡è½½operator*, operator-&gt;æ“ä½œç¬¦  å®ç°release()ï¼Œ reset()">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-09-24T16:00:00.000Z">
<meta property="article:modified_time" content="2021-09-24T16:00:00.000Z">
<meta property="article:author" content="larry">
<meta property="article:tag" content="wheel">
<meta name="twitter:card" content="summary"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="æ–‡ç« ç›®å½•"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="ç«™ç‚¹æ¦‚è§ˆ"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="larry"><img width="96" loading="lazy" src="/images/avatar.jpg" alt="larry"><span class="site-author-status" title="Looking for you.">ğŸŒ‘</span></a><div class="site-author-name"><a href="/about/">larry</a></div><a class="site-name" href="/about/site.html">æ‹‰ç‘å›ã®å°çª</a><sub class="site-subtitle"></sub><div class="site-desciption">æ¯å¤©éƒ½æ˜¯æ–°çš„ä¸€å¤©å‘¢</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="é¦–é¡µ"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="å½’æ¡£"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">86</span></a></div><div class="site-state-item"><a href="/categories/" title="åˆ†ç±»"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">13</span></a></div><div class="site-state-item"><a href="/tags/" title="æ ‡ç­¾"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">42</span></a></div><a class="site-state-item hty-icon-button" href="/about/#comment" title="ç•™è¨€æ¿"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-clipboard-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="/atom.xml" title="RSS" target="_blank" style="color:orange"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-rss-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/larrystd" title="GitHub" target="_blank" style="color:#6e5494"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.zhihu.com/people/bu-qu-dou-yin-bu-gai-ming" title="çŸ¥ä¹" target="_blank" style="color:#0084FF"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-zhihu-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="Venray.Kong@outlook.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://travellings.link" title="Travelling" target="_blank" style="color:var(--hty-text-color)"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-train-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a><a class="links-item hty-icon-button" href="/girls/" title="å–œæ¬¢çš„å¥³å­©å­" style="color:hotpink"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-women-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#shared-ptr"><span class="toc-number">1.</span> <span class="toc-text">shared_ptr</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%B3%E8%B7%83%E8%A1%A8"><span class="toc-number">2.</span> <span class="toc-text">è·³è·ƒè¡¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E6%98%93vector%E5%AE%9E%E7%8E%B0"><span class="toc-number">3.</span> <span class="toc-text">ç®€æ˜“vectorå®ç°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E5%85%88%E9%98%9F%E5%88%97-%E5%9F%BA%E4%BA%8E%E5%A0%86%E5%AE%9E%E7%8E%B0"><span class="toc-number">4.</span> <span class="toc-text">ä¼˜å…ˆé˜Ÿåˆ—, åŸºäºå †å®ç°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hashmap"><span class="toc-number">5.</span> <span class="toc-text">hashmap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AVL-tree"><span class="toc-number">6.</span> <span class="toc-text">AVL tree</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://larrystd.github.io/cpp%E8%BF%9B%E9%98%B6/2021-09-25-%E5%B8%B8%E7%94%A8%E7%B1%BB%E7%9A%84%E5%AE%9E%E7%8E%B0/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="larry"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="æ‹‰ç‘å›ã®å°çª"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">å¸¸ç”¨ç±»å®ç° shared_ptr skip_list heap<a class="post-edit-link" href="https://github.com/larrystd/larrystd.github.io/tree/hexo/source/_posts/cppè¿›é˜¶/2021-09-25-å¸¸ç”¨ç±»çš„å®ç°.md" target="_blank" title="ç¼–è¾‘" rel="noopener"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-edit-line"></use></svg></a></h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="åˆ›å»ºæ—¶é—´ï¼š2021-09-25 00:00:00" itemprop="dateCreated datePublished" datetime="2021-09-25T00:00:00+08:00">2021-09-25</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="æœ¬æ–‡å­—æ•°"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-file-word-line"></use></svg></span> <span title="æœ¬æ–‡å­—æ•°">5.6k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ—¶é•¿"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-timer-line"></use></svg></span> <span title="é˜…è¯»æ—¶é•¿">30m</span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/cpp-advanced/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">cpp advanced</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/wheel/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">wheel</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#6200ee;"><blockquote>
<p>ä¼šç”¨åªæ˜¯çš®æ¯›, éœ€è¦å¯¹å¸¸ç”¨ç±»è¿›è¡Œç®€å•å®ç°, ä¾‹å¦‚shared_ptr, mutexç­‰</p>
</blockquote>
<h3 id="shared-ptr"><a href="#shared-ptr" class="headerlink" title="shared_ptr"></a>shared_ptr</h3><ul>
<li><p>æ ¸å¿ƒ, threadåŠ é”, å¯¹è±¡è®¡æ•°, å°è£…çš„åŸå§‹æŒ‡é’ˆ</p>
</li>
<li><p>é‡è½½operator*, operator-&gt;æ“ä½œç¬¦</p>
</li>
<li><p>å®ç°release()ï¼Œ reset()</p>
</li>
</ul>
<span id="more"></span>

<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;mutex></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;thread></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">class</span> <span class="token class-name">Shared_Ptr</span><span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Shared_Ptr</span><span class="token punctuation">(</span>T<span class="token operator">*</span> ptr <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
		<span class="token operator">:</span><span class="token function">_pPtr</span><span class="token punctuation">(</span>ptr<span class="token punctuation">)</span>
		<span class="token punctuation">,</span> <span class="token function">_pRefCount</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">,</span> <span class="token function">_pMutex</span><span class="token punctuation">(</span><span class="token keyword">new</span> mutex<span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
	<span class="token operator">~</span><span class="token function">Shared_Ptr</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">Release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token function">Shared_Ptr</span><span class="token punctuation">(</span><span class="token keyword">const</span> Shared_Ptr<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> sp<span class="token punctuation">)</span>
		<span class="token operator">:</span><span class="token function">_pPtr</span><span class="token punctuation">(</span>sp<span class="token punctuation">.</span>_pPtr<span class="token punctuation">)</span>
		<span class="token punctuation">,</span> <span class="token function">_pRefCount</span><span class="token punctuation">(</span>sp<span class="token punctuation">.</span>_pRefCount<span class="token punctuation">)</span>
		<span class="token punctuation">,</span> <span class="token function">_pMutex</span><span class="token punctuation">(</span>sp<span class="token punctuation">.</span>_pMutex<span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">AddRefCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	Shared_Ptr<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Shared_Ptr<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> sp<span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token comment">//if (this != &amp;sp)</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>_pPtr <span class="token operator">!=</span> sp<span class="token punctuation">.</span>_pPtr<span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token comment">// é‡Šæ”¾ç®¡ç†çš„æ—§èµ„æº</span>
			<span class="token function">Release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">// å…±äº«ç®¡ç†æ–°å¯¹è±¡çš„èµ„æºï¼Œå¹¶å¢åŠ å¼•ç”¨è®¡æ•°</span>
			_pPtr <span class="token operator">=</span> sp<span class="token punctuation">.</span>_pPtr<span class="token punctuation">;</span>
			_pRefCount <span class="token operator">=</span> sp<span class="token punctuation">.</span>_pRefCount<span class="token punctuation">;</span>
			_pMutex <span class="token operator">=</span> sp<span class="token punctuation">.</span>_pMutex<span class="token punctuation">;</span>
			<span class="token function">AddRefCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
		<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
    <span class="token comment">/// è§£åœ°å€, è¿”å›å¼•ç”¨</span>
	T<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token operator">*</span>_pPtr<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token comment">/// è¿”å›åœ°å€</span>
	T<span class="token operator">*</span> <span class="token keyword">operator</span><span class="token operator">-></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> _pPtr<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">int</span> <span class="token function">UseCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token operator">*</span>_pRefCount<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
	T<span class="token operator">*</span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> _pPtr<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
    
	<span class="token keyword">void</span> <span class="token function">AddRefCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		_pMutex<span class="token operator">-></span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token operator">++</span><span class="token punctuation">(</span><span class="token operator">*</span>_pRefCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
		_pMutex<span class="token operator">-></span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">Release</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">bool</span> deleteflag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
		_pMutex<span class="token operator">-></span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">--</span><span class="token punctuation">(</span><span class="token operator">*</span>_pRefCount<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token keyword">delete</span> _pRefCount<span class="token punctuation">;</span>
			<span class="token keyword">delete</span> _pPtr<span class="token punctuation">;</span>
			deleteflag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
		_pMutex<span class="token operator">-></span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>deleteflag <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
			<span class="token keyword">delete</span> _pMutex<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> <span class="token operator">*</span>_pRefCount<span class="token punctuation">;</span>
	T<span class="token operator">*</span> _pPtr<span class="token punctuation">;</span>
	mutex<span class="token operator">*</span> _pMutex<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span></code></pre>

<h3 id="è·³è·ƒè¡¨"><a href="#è·³è·ƒè¡¨" class="headerlink" title="è·³è·ƒè¡¨"></a>è·³è·ƒè¡¨</h3><pre class="language-cpp" data-language="cpp"><code class="language-cpp">
<span class="token comment">/// ListNode</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">struct</span> <span class="token class-name">SkipNode</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> key<span class="token punctuation">;</span>
	T value<span class="token punctuation">;</span>
	vector<span class="token operator">&lt;</span>SkipNode<span class="token operator">*</span><span class="token operator">></span> next<span class="token punctuation">;</span>

	<span class="token function">SkipNode</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">,</span> T v<span class="token punctuation">,</span> <span class="token keyword">int</span> level<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">//æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token class-name">SkipNode</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">SkipNode</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">,</span> T v<span class="token punctuation">,</span> <span class="token keyword">int</span> level<span class="token punctuation">)</span> 
	<span class="token operator">:</span> <span class="token function">key</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">value</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> level<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		next<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>


<span class="token comment">/// skipList</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">class</span> <span class="token class-name">SkipList</span>
<span class="token punctuation">&#123;</span>

<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token comment">//å¤´ç»“ç‚¹</span>
	SkipNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> head<span class="token punctuation">;</span>
	
	<span class="token comment">//åˆ—è¡¨æœ€å¤§å±‚æ•°</span>
	<span class="token keyword">int</span> maxLevel<span class="token punctuation">;</span>

	<span class="token comment">//æ•´å‹çš„æœ€å°å€¼å’Œæœ€å¤§å€¼</span>
	<span class="token keyword">const</span> <span class="token keyword">int</span> minInt <span class="token operator">=</span> <span class="token class-name">numeric_limits</span><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> <span class="token keyword">int</span> maxInt <span class="token operator">=</span> <span class="token class-name">numeric_limits</span><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token comment">//æ„é€ å‡½æ•°</span>
	<span class="token function">SkipList</span><span class="token punctuation">(</span><span class="token keyword">int</span> maxLevel<span class="token punctuation">,</span> T iniValue<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//ææ„å‡½æ•°</span>
	<span class="token operator">~</span><span class="token function">SkipList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//éšæœºå±‚æ•°æ–¹æ³•</span>
	<span class="token keyword">int</span> <span class="token function">randomLevel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//æ’å…¥, æŸ¥æ‰¾ï¼Œ åˆ é™¤</span>
	SkipNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">,</span> T v<span class="token punctuation">)</span><span class="token punctuation">;</span>
	SkipNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>
	SkipNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token function">deleteNode</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//æ‰“å°</span>
	<span class="token keyword">void</span> <span class="token function">printNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">private</span><span class="token operator">:</span>

	<span class="token comment">//å°¾èŠ‚ç‚¹</span>
	SkipNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> tail<span class="token punctuation">;</span>
	
	<span class="token comment">//æ‰¾åˆ°å½“å‰åˆ—è¡¨æˆ–è€…nodeçš„æœ€å¤§å±‚æ•°</span>
	<span class="token keyword">int</span> <span class="token function">nodeLevel</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>SkipNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span><span class="token operator">></span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">//åˆå§‹åŒ–</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token class-name">SkipList</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">SkipList</span><span class="token punctuation">(</span><span class="token keyword">int</span> maxLevel<span class="token punctuation">,</span> T iniValue<span class="token punctuation">)</span>
	<span class="token operator">:</span> <span class="token function">maxLevel</span><span class="token punctuation">(</span>maxLevel<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token comment">//åˆå§‹åŒ–å¤´ç»“ç‚¹å’Œå°¾èŠ‚ç‚¹ä¸ºæ•´å‹æœ€å°å€¼å’Œæœ€å¤§å€¼</span>
	head <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token generic-function"><span class="token function">SkipNode</span><span class="token generic class-name"><span class="token operator">&lt;</span>T<span class="token operator">></span></span></span><span class="token punctuation">(</span>minInt<span class="token punctuation">,</span> iniValue<span class="token punctuation">,</span> maxLevel<span class="token punctuation">)</span><span class="token punctuation">;</span>
	tail <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token generic-function"><span class="token function">SkipNode</span><span class="token generic class-name"><span class="token operator">&lt;</span>T<span class="token operator">></span></span></span><span class="token punctuation">(</span>maxInt<span class="token punctuation">,</span> iniValue<span class="token punctuation">,</span> maxLevel<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//æ‰€æœ‰å±‚æ•°ä¸Šçš„å¤´ç»“ç‚¹æŒ‡å‘å°¾èŠ‚ç‚¹</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> maxLevel<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		head<span class="token operator">-></span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> tail<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span> SkipList<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">SkipList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">delete</span> head<span class="token punctuation">;</span>
	<span class="token keyword">delete</span> tail<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/// éšæœºå±‚</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token keyword">int</span> <span class="token class-name">SkipList</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">randomLevel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> random_level <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> seed <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">static</span> default_random_engine <span class="token function">e</span><span class="token punctuation">(</span>seed<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">/// 0-1åˆ†å¸ƒ</span>
	<span class="token keyword">static</span> uniform_int_distribution<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">u</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">u</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> random_level <span class="token operator">&lt;</span> maxLevel<span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		random_level<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token comment">/// å¦‚æœu(e)ä¸€ç›´ä¸æ»¡è¶³ç›´åˆ°æœ€å¤§å±‚æ•°, åˆ™é€‰æ‹©æœ€å¤§å±‚</span>

	<span class="token keyword">return</span> random_level<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/// è¿”å›æœ€å¤§å±‚æ•°</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token keyword">int</span> <span class="token class-name">SkipList</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">nodeLevel</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>SkipNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span><span class="token operator">></span> next<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> node_level <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	
	<span class="token keyword">if</span> <span class="token punctuation">(</span>next<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">-></span>key <span class="token operator">==</span> maxInt<span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> node_level<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> next<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">nullptr</span> <span class="token operator">&amp;&amp;</span> next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-></span>key <span class="token operator">!=</span> maxInt<span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			node_level<span class="token operator">++</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">&#123;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">return</span> node_level<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/// åŸºæœ¬æ“ä½œ</span>

<span class="token comment">/*æ’å…¥ï¼š
1ï¼‰é¦–å…ˆç”¨æŸ¥æ‰¾å‡½æ•°æ¥åˆ¤æ–­è¯¥ç»“ç‚¹æ˜¯å¦å·²ç»å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™æ›´æ–°è¯¥ç»“ç‚¹çš„å€¼
2ï¼‰è·å–æ–°èŠ‚ç‚¹çš„éšæœºå±‚æ•°
3ï¼‰æ‰¾åˆ°åˆé€‚çš„æ’å…¥ä½ç½®
4ï¼‰æ’å…¥ï¼Œå¹¶è°ƒæ•´æ¯å±‚å‰ånodeçš„æŒ‡é’ˆ*/</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span> SkipNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token class-name">SkipList</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">,</span> T v<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> x_level <span class="token operator">=</span> <span class="token function">randomLevel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	SkipNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> new_node <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
	SkipNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> tmp <span class="token operator">=</span> head<span class="token punctuation">;</span>

	new_node <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>new_node<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		
		new_node<span class="token operator">-></span>value <span class="token operator">=</span> v<span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"\nThis node "</span> <span class="token operator">&lt;&lt;</span> k <span class="token operator">&lt;&lt;</span> <span class="token string">" has already existed. And its value has been updated to "</span> <span class="token operator">&lt;&lt;</span> v <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		<span class="token keyword">return</span> head<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"key: "</span> <span class="token operator">&lt;&lt;</span> k <span class="token operator">&lt;&lt;</span> <span class="token string">", randomLevel: "</span> <span class="token operator">&lt;&lt;</span> x_level <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	new_node <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token generic-function"><span class="token function">SkipNode</span><span class="token generic class-name"><span class="token operator">&lt;</span>T<span class="token operator">></span></span></span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> v<span class="token punctuation">,</span> x_level<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token punctuation">(</span>x_level <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">></span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span>tmp<span class="token operator">-></span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">nullptr</span> <span class="token operator">&amp;&amp;</span> tmp<span class="token operator">-></span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-></span>key <span class="token operator">&lt;</span> k<span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			tmp <span class="token operator">=</span> tmp<span class="token operator">-></span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>

		new_node<span class="token operator">-></span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token operator">-></span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
		tmp<span class="token operator">-></span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> new_node<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">return</span> head<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*æŸ¥æ‰¾ï¼š
ç”±äºåˆ—è¡¨æœ‰åºï¼Œé¦–å…ˆæ‰¾åˆ°å°äºè¯¥ç»“ç‚¹çš„æœ€è¿‘çš„ç»“ç‚¹ï¼Œå¦‚æœä¸‹ä¸€ä¸ªç»“ç‚¹ç­‰äºç›®æ ‡ç»“ç‚¹ï¼Œåˆ™è¿”å›è¯¥èŠ‚ç‚¹ã€‚
å¦‚æœä¸æ˜¯ï¼Œåˆ™è¿”å›ç©º*/</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span> SkipNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token class-name">SkipList</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	SkipNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> tmp <span class="token operator">=</span> head<span class="token punctuation">;</span>
	<span class="token keyword">int</span> current_level <span class="token operator">=</span> <span class="token function">nodeLevel</span><span class="token punctuation">(</span>tmp<span class="token operator">-></span>next<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token punctuation">(</span>current_level <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">></span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span>tmp<span class="token operator">-></span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">nullptr</span> <span class="token operator">&amp;&amp;</span> tmp<span class="token operator">-></span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-></span>key <span class="token operator">&lt;</span> x<span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			tmp <span class="token operator">=</span> tmp<span class="token operator">-></span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
	tmp <span class="token operator">=</span> tmp<span class="token operator">-></span>next<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>tmp<span class="token operator">-></span>key <span class="token operator">==</span> x<span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"\nThis key "</span> <span class="token operator">&lt;&lt;</span> x <span class="token operator">&lt;&lt;</span> <span class="token string">" has been found\n"</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> tmp<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">&#123;</span>
		<span class="token comment">//cout &lt;&lt; " \nThis key " &lt;&lt; x &lt;&lt; " doesn't exit\n";</span>
		<span class="token keyword">return</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*åˆ é™¤ï¼š
1) ç”¨ find(x) æ–¹æ³•åˆ¤æ–­è¯¥ç»“ç‚¹æ˜¯å¦å­˜åœ¨. å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¿”å›å½“å‰list, å¹¶å‘ŠçŸ¥è¯¥ç»“ç‚¹ä¸å­˜åœ¨ã€‚
2) æ‰¾åˆ°å°äºè¯¥ç»“ç‚¹çš„æœ€è¿‘çš„ç»“ç‚¹ã€‚
3) æ›´æ”¹è¯¥èŠ‚ç‚¹æ¯å±‚çš„å‰é¢çš„ç»“ç‚¹çš„æŒ‡é’ˆã€‚*/</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span> SkipNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token class-name">SkipList</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">deleteNode</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	SkipNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> node <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>node<span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"\n This deleting node"</span> <span class="token operator">&lt;&lt;</span> x <span class="token operator">&lt;&lt;</span> <span class="token string">"doesn't exist"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		<span class="token keyword">return</span> head<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">&#123;</span>
		SkipNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> tmp <span class="token operator">=</span> head<span class="token punctuation">;</span>
		<span class="token keyword">int</span> x_level <span class="token operator">=</span> node<span class="token operator">-></span>next<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"\nThe deleting node "</span> <span class="token operator">&lt;&lt;</span> x <span class="token operator">&lt;&lt;</span> <span class="token string">"'s level is "</span> <span class="token operator">&lt;&lt;</span> x_level <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token punctuation">(</span>x_level <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">></span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span>tmp<span class="token operator">-></span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">nullptr</span> <span class="token operator">&amp;&amp;</span> tmp<span class="token operator">-></span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-></span>key <span class="token operator">&lt;</span> x<span class="token punctuation">)</span>
			<span class="token punctuation">&#123;</span>
				tmp <span class="token operator">=</span> tmp<span class="token operator">-></span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token punctuation">&#125;</span>
			tmp<span class="token operator">-></span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token operator">-></span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-></span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

			cout <span class="token operator">&lt;&lt;</span> <span class="token string">"This node "</span> <span class="token operator">&lt;&lt;</span> x <span class="token operator">&lt;&lt;</span> <span class="token string">" has been deleted from level "</span> <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>

		<span class="token keyword">return</span> head<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/// æ‰“å°</span>
<span class="token comment">// åˆ†å±‚æ‰“å°</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token keyword">void</span> <span class="token class-name">SkipList</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">printNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> maxLevel<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		SkipNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> tmp <span class="token operator">=</span> head<span class="token punctuation">;</span>
		<span class="token keyword">int</span> lineLen <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>tmp<span class="token operator">-></span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-></span>key <span class="token operator">!=</span> maxInt<span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			cout <span class="token operator">&lt;&lt;</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>
			cout <span class="token operator">&lt;&lt;</span> <span class="token string">"This is level "</span> <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">":"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
			cout <span class="token operator">&lt;&lt;</span> <span class="token string">"&#123;"</span><span class="token punctuation">;</span>

			<span class="token keyword">while</span> <span class="token punctuation">(</span>tmp<span class="token operator">-></span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">nullptr</span> <span class="token operator">&amp;&amp;</span> tmp<span class="token operator">-></span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-></span>key <span class="token operator">!=</span> maxInt<span class="token punctuation">)</span>
			<span class="token punctuation">&#123;</span>
				cout <span class="token operator">&lt;&lt;</span> <span class="token string">"("</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"Key: "</span> <span class="token operator">&lt;&lt;</span> tmp<span class="token operator">-></span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-></span>key <span class="token operator">&lt;&lt;</span> <span class="token string">", "</span><span class="token punctuation">;</span>
				cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Value: "</span> <span class="token operator">&lt;&lt;</span> tmp<span class="token operator">-></span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-></span>value <span class="token operator">&lt;&lt;</span> <span class="token string">")"</span><span class="token punctuation">;</span>

				tmp <span class="token operator">=</span> tmp<span class="token operator">-></span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

				<span class="token keyword">if</span> <span class="token punctuation">(</span>tmp<span class="token operator">-></span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">nullptr</span> <span class="token operator">&amp;&amp;</span> tmp<span class="token operator">-></span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-></span>key <span class="token operator">!=</span> maxInt<span class="token punctuation">)</span>
				<span class="token punctuation">&#123;</span>
					cout <span class="token operator">&lt;&lt;</span> <span class="token string">", "</span><span class="token punctuation">;</span>
				<span class="token punctuation">&#125;</span>

				<span class="token keyword">if</span> <span class="token punctuation">(</span>lineLen<span class="token operator">++</span> <span class="token operator">%</span> <span class="token number">5</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>
			<span class="token punctuation">&#125;</span>
			cout <span class="token operator">&lt;&lt;</span> <span class="token string">"&#125;"</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
</code></pre>

<h3 id="ç®€æ˜“vectorå®ç°"><a href="#ç®€æ˜“vectorå®ç°" class="headerlink" title="ç®€æ˜“vectorå®ç°"></a>ç®€æ˜“vectorå®ç°</h3><pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">once</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;cassert></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;algorithm></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token keyword">int</span> DEAULT_CAPACITY <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">class</span> <span class="token class-name">Vector</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token comment">//å„ç§æ„é€ å‡½æ•°å’Œææ„å‡½æ•°</span>
    <span class="token function">Vector</span><span class="token punctuation">(</span><span class="token keyword">int</span> cap <span class="token operator">=</span> DEAULT_CAPACITY<span class="token punctuation">,</span> <span class="token keyword">int</span> sz <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">const</span> T v <span class="token operator">=</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">:</span>
        <span class="token function">capacity</span><span class="token punctuation">(</span>cap<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">size</span><span class="token punctuation">(</span>sz<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        data <span class="token operator">=</span> <span class="token keyword">new</span> T<span class="token punctuation">[</span>capacity<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">Vector</span><span class="token punctuation">(</span><span class="token keyword">const</span> T <span class="token operator">*</span>arr<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        size <span class="token operator">=</span> n<span class="token punctuation">;</span>
        capacity <span class="token operator">=</span> n<span class="token punctuation">;</span>
        data <span class="token operator">=</span> <span class="token keyword">new</span> T<span class="token punctuation">[</span>capacity<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">Vector</span><span class="token punctuation">(</span><span class="token keyword">const</span> T <span class="token operator">*</span>arr<span class="token punctuation">,</span> <span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">Vector</span><span class="token punctuation">(</span><span class="token keyword">const</span> Vector<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token operator">&amp;</span>v<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        size <span class="token operator">=</span> v<span class="token punctuation">.</span>size<span class="token punctuation">;</span>
        capacity <span class="token operator">=</span> v<span class="token punctuation">.</span>capacity<span class="token punctuation">;</span>
        data <span class="token operator">=</span> <span class="token keyword">new</span> T<span class="token punctuation">[</span>capacity<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">Vector</span><span class="token punctuation">(</span><span class="token keyword">const</span> Vector<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token operator">&amp;</span>v<span class="token punctuation">,</span> <span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        size <span class="token operator">=</span> r <span class="token operator">-</span> l<span class="token punctuation">;</span>
        capacity <span class="token operator">=</span> size<span class="token punctuation">;</span>
        data <span class="token operator">=</span> <span class="token keyword">new</span> T<span class="token punctuation">[</span>capacity<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i <span class="token operator">+</span> l<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token operator">~</span><span class="token function">Vector</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
    Vector<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> <span class="token keyword">operator</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Vector<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token operator">&amp;</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//è·å–ä¿¡æ¯</span>
    <span class="token keyword">int</span> <span class="token function">GetCapacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> capacity<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
    <span class="token keyword">int</span> <span class="token function">GetSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> size<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
    <span class="token keyword">bool</span> <span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token punctuation">(</span>size <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
    <span class="token keyword">int</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">const</span> T <span class="token operator">&amp;</span>v<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>

    <span class="token comment">//æ”¹å˜å…ƒç´ </span>
    <span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">,</span> <span class="token keyword">const</span> T <span class="token operator">&amp;</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">CopyFrom</span><span class="token punctuation">(</span><span class="token keyword">const</span> T <span class="token operator">*</span>v<span class="token punctuation">,</span> <span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">const</span> T <span class="token operator">&amp;</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//é‡è½½è¿ç®—ç¬¦</span>
    <span class="token comment">/*T&amp; operator [] (const int p) &#123;
        assert(p >= 0 &amp;&amp; p &lt; size);
        return data[p];
    &#125;*/</span>
    <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>
    <span class="token keyword">friend</span> ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>ostream <span class="token operator">&amp;</span>o<span class="token punctuation">,</span> <span class="token keyword">const</span> Vector<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token operator">&amp;</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">expand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>T <span class="token operator">&amp;</span>a<span class="token punctuation">,</span> T <span class="token operator">&amp;</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> T tmp <span class="token operator">=</span> a<span class="token punctuation">;</span> a <span class="token operator">=</span> b<span class="token punctuation">;</span> b <span class="token operator">=</span> tmp<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>

<span class="token keyword">protected</span><span class="token operator">:</span>
    <span class="token keyword">int</span> capacity<span class="token punctuation">;</span>    <span class="token comment">//å®¹é‡</span>
    <span class="token keyword">int</span> size<span class="token punctuation">;</span>        <span class="token comment">//Vectorå¤§å°</span>
    T <span class="token operator">*</span>data<span class="token punctuation">;</span>        <span class="token comment">//å®é™…æ•°æ®</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>
ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>ostream <span class="token operator">&amp;</span>o<span class="token punctuation">,</span> <span class="token keyword">const</span> Vector<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token operator">&amp;</span>v<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> v<span class="token punctuation">.</span><span class="token function">GetSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        o <span class="token operator">&lt;&lt;</span> v<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> o<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>
Vector<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> Vector<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Vector<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token operator">&amp;</span>v<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>data <span class="token operator">==</span> v<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span>data<span class="token punctuation">;</span>
    size <span class="token operator">=</span> v<span class="token punctuation">.</span>size<span class="token punctuation">;</span>
    capacity <span class="token operator">=</span> v<span class="token punctuation">.</span>capacity<span class="token punctuation">;</span>
    data <span class="token operator">=</span> <span class="token keyword">new</span> T<span class="token punctuation">[</span>v<span class="token punctuation">.</span>capacity<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">CopyFrom</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>data<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">void</span> <span class="token class-name">Vector</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">CopyFrom</span><span class="token punctuation">(</span><span class="token keyword">const</span> T <span class="token operator">*</span>v<span class="token punctuation">,</span> <span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> l<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> r<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        data<span class="token punctuation">[</span>size<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">void</span> <span class="token class-name">Vector</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">expand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>size <span class="token operator">==</span> capacity<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        T <span class="token operator">*</span>OldData <span class="token operator">=</span> data<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>capacity <span class="token operator">&lt;</span> DEAULT_CAPACITY<span class="token punctuation">)</span> capacity <span class="token operator">=</span> DEAULT_CAPACITY<span class="token punctuation">;</span>        <span class="token comment">//é˜²æ­¢capacityä¸º0æ—¶å€™å‡ºé”™</span>
		<span class="token comment">/// å®¹é‡å˜ä¸ºä¸¤å€</span>
        capacity <span class="token operator">&lt;&lt;=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        data <span class="token operator">=</span> <span class="token keyword">new</span> T<span class="token punctuation">[</span>capacity<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token comment">/// æ—§æ•°æ®olddataæŒ‡é’ˆæ‹·è´åˆ°æ–°æ•°æ®dataæŒ‡é’ˆä½ç½®ä¸­</span>
        <span class="token function">CopyFrom</span><span class="token punctuation">(</span>OldData<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> OldData<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">void</span> <span class="token class-name">Vector</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span> v<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">assert</span><span class="token punctuation">(</span>p <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> p <span class="token operator">&lt;=</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> p<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> data<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    data<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">;</span>
    size<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">void</span> <span class="token class-name">Vector</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">const</span> T <span class="token operator">&amp;</span>v<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">insert</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">void</span> <span class="token class-name">Vector</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> p<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    size<span class="token operator">--</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">void</span> <span class="token class-name">Vector</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">assert</span><span class="token punctuation">(</span>size <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">remove</span><span class="token punctuation">(</span>size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">void</span> <span class="token class-name">Vector</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>size<span class="token punctuation">)</span> <span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">int</span> <span class="token class-name">Vector</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">const</span> T <span class="token operator">&amp;</span>p<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">==</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">return</span> i<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">void</span> <span class="token class-name">Vector</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    std<span class="token double-colon punctuation">::</span><span class="token function">sort</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> data <span class="token operator">+</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>

<h3 id="ä¼˜å…ˆé˜Ÿåˆ—-åŸºäºå †å®ç°"><a href="#ä¼˜å…ˆé˜Ÿåˆ—-åŸºäºå †å®ç°" class="headerlink" title="ä¼˜å…ˆé˜Ÿåˆ—, åŸºäºå †å®ç°"></a>ä¼˜å…ˆé˜Ÿåˆ—, åŸºäºå †å®ç°</h3><ul>
<li>ä½¿ç”¨å¼€é“¾æ³•</li>
</ul>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">class</span> <span class="token class-name">PriorityQueue</span>
<span class="token punctuation">&#123;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">int</span> Capacity <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>    <span class="token comment">//é˜Ÿåˆ—å®¹é‡</span>
    <span class="token keyword">int</span> size<span class="token punctuation">;</span>                 <span class="token comment">//é˜Ÿåˆ—å¤§å°</span>
    T<span class="token operator">*</span> data<span class="token punctuation">;</span>             <span class="token comment">//é˜Ÿåˆ—å˜é‡</span>

<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">PriorityQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">PriorityQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> <span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">bool</span> <span class="token function">Full</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//åˆ¤æ»¡</span>
    <span class="token keyword">bool</span> <span class="token function">Empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//åˆ¤ç©º</span>
    <span class="token keyword">void</span> <span class="token function">Push</span><span class="token punctuation">(</span>T key<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//å…¥é˜Ÿ</span>
    <span class="token keyword">void</span> <span class="token function">Pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å‡ºé˜Ÿ</span>
    <span class="token keyword">void</span> <span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ¸…ç©º</span>
    T <span class="token function">Top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//é˜Ÿé¦–</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token class-name">PriorityQueue</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">PriorityQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    data <span class="token operator">=</span> <span class="token punctuation">(</span>T<span class="token operator">*</span><span class="token punctuation">)</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>data<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"Allocate dynamic memory"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
PriorityQueue<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">PriorityQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">Empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token function">Pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token comment">//åˆ¤ç©º</span>
<span class="token keyword">bool</span> <span class="token class-name">PriorityQueue</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">Empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>size <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token comment">//æ¸…ç©º</span>
<span class="token keyword">void</span> <span class="token class-name">PriorityQueue</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">Empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token function">Pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token comment">//åˆ¤æ»¡</span>
<span class="token keyword">bool</span> <span class="token class-name">PriorityQueue</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">Full</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>size <span class="token operator">==</span> Capacity<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token comment">//å¤§å°</span>
<span class="token keyword">int</span> <span class="token class-name">PriorityQueue</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> size<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token comment">//å…¥é˜Ÿ</span>
<span class="token keyword">void</span> <span class="token class-name">PriorityQueue</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">Push</span><span class="token punctuation">(</span>T key<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token comment">// ç©ºåˆ™ç›´æ¥å…¥é˜Ÿ  ä¸èƒ½çœç•¥</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">Empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        data<span class="token punctuation">[</span><span class="token operator">++</span>size<span class="token punctuation">]</span> <span class="token operator">=</span> key<span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">int</span> i<span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">Full</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"Priority queue is full\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token operator">++</span>size<span class="token punctuation">;</span> data<span class="token punctuation">[</span>i <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">></span> key<span class="token punctuation">;</span> i <span class="token operator">/=</span> <span class="token number">2</span><span class="token punctuation">)</span>
        data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>i <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> key<span class="token punctuation">;</span>

    <span class="token comment">//if (key != data[i / 2])          //å¦‚æœä¸èƒ½æ’å…¥é‡å¤å€¼ ç”¨ä¸‹é¢çš„</span>
    <span class="token comment">//  data[i] = key;</span>
    <span class="token comment">//else</span>
    <span class="token comment">//&#123;</span>
    <span class="token comment">//  size--;</span>
    <span class="token comment">//  perror("Same value");</span>
    <span class="token comment">//&#125;</span>

<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token comment">//å‡ºé˜Ÿ</span>
<span class="token keyword">void</span> <span class="token class-name">PriorityQueue</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">Pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">,</span> child<span class="token punctuation">;</span>
    T min<span class="token punctuation">,</span> last<span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">Empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"Empty queue\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    min <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    last <span class="token operator">=</span> data<span class="token punctuation">[</span>size<span class="token operator">--</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">&lt;=</span> size<span class="token punctuation">;</span> i <span class="token operator">=</span> child<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        child <span class="token operator">=</span> i <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>child <span class="token operator">!=</span> size <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">[</span>child <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> data<span class="token punctuation">[</span>child<span class="token punctuation">]</span><span class="token punctuation">)</span>
            child<span class="token operator">++</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>last <span class="token operator">></span> data<span class="token punctuation">[</span>child<span class="token punctuation">]</span><span class="token punctuation">)</span>
            data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>child<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> last<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token comment">//é˜Ÿé¦–</span>
T <span class="token class-name">PriorityQueue</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">Top</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">Empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"Priority queue is full\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>


<h3 id="hashmap"><a href="#hashmap" class="headerlink" title="hashmap"></a>hashmap</h3><pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">_HASHMAP_H_</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_HASHMAP_H_</span></span>



<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">Key</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">Value</span><span class="token operator">></span>
<span class="token keyword">class</span> <span class="token class-name">HashNode</span>
<span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    Key    _key<span class="token punctuation">;</span>
    Value  _value<span class="token punctuation">;</span>
    HashNode <span class="token operator">*</span>next<span class="token punctuation">;</span>

    <span class="token function">HashNode</span><span class="token punctuation">(</span>Key key<span class="token punctuation">,</span> Value value<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        _key <span class="token operator">=</span> key<span class="token punctuation">;</span>
        _value <span class="token operator">=</span> value<span class="token punctuation">;</span>
        next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token operator">~</span><span class="token function">HashNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>

    <span class="token punctuation">&#125;</span>
    HashNode<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> HashNode<span class="token operator">&amp;</span> node<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        _key  <span class="token operator">=</span> node<span class="token punctuation">.</span>_key<span class="token punctuation">;</span>
        _value <span class="token operator">=</span> node<span class="token punctuation">.</span>_value<span class="token punctuation">;</span>
        next <span class="token operator">=</span> node<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">Key</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">Value</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">HashFunc</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">EqualKey</span><span class="token operator">></span>
<span class="token keyword">class</span> <span class="token class-name">HashMap</span>
<span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">HashMap</span><span class="token punctuation">(</span><span class="token keyword">int</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">bool</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">const</span> Key<span class="token operator">&amp;</span> key<span class="token punctuation">,</span> <span class="token keyword">const</span> Value<span class="token operator">&amp;</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">bool</span> <span class="token function">del</span><span class="token punctuation">(</span><span class="token keyword">const</span> Key<span class="token operator">&amp;</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Value<span class="token operator">&amp;</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">const</span> Key<span class="token operator">&amp;</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Value<span class="token operator">&amp;</span> <span class="token keyword">operator</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">const</span> Key<span class="token operator">&amp;</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    HashFunc hash<span class="token punctuation">;</span>
    EqualKey equal<span class="token punctuation">;</span>
    HashNode<span class="token operator">&lt;</span>Key<span class="token punctuation">,</span> Value<span class="token operator">></span> <span class="token operator">*</span><span class="token operator">*</span>table<span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> _size<span class="token punctuation">;</span>
    Value ValueNULL<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>


<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">Key</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">Value</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">HashFunc</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">EqualKey</span><span class="token operator">></span>
<span class="token class-name">HashMap</span><span class="token operator">&lt;</span>Key<span class="token punctuation">,</span> Value<span class="token punctuation">,</span> HashFunc<span class="token punctuation">,</span> EqualKey<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">HashMap</span><span class="token punctuation">(</span><span class="token keyword">int</span> size<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">_size</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">hash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    table <span class="token operator">=</span> <span class="token keyword">new</span> HashNode<span class="token operator">&lt;</span>Key<span class="token punctuation">,</span> Value<span class="token operator">></span><span class="token operator">*</span><span class="token punctuation">[</span>_size<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> _size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        table<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>



<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">Key</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">Value</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">HashFunc</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">EqualKey</span><span class="token operator">></span>
HashMap<span class="token operator">&lt;</span>Key<span class="token punctuation">,</span> Value<span class="token punctuation">,</span> HashFunc<span class="token punctuation">,</span> EqualKey<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> _size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        HashNode<span class="token operator">&lt;</span>Key<span class="token punctuation">,</span> Value<span class="token operator">></span> <span class="token operator">*</span>currentNode <span class="token operator">=</span> table<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>currentNode<span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            HashNode<span class="token operator">&lt;</span>Key<span class="token punctuation">,</span> Value<span class="token operator">></span> <span class="token operator">*</span>temp <span class="token operator">=</span> currentNode<span class="token punctuation">;</span>
            currentNode <span class="token operator">=</span> currentNode<span class="token operator">-></span>next<span class="token punctuation">;</span>
            <span class="token keyword">delete</span> temp<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">delete</span> table<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>


<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">Key</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">Value</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">HashFunc</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">EqualKey</span><span class="token operator">></span>
<span class="token keyword">bool</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span>Key<span class="token punctuation">,</span> Value<span class="token punctuation">,</span> HashFunc<span class="token punctuation">,</span> EqualKey<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">const</span> Key<span class="token operator">&amp;</span> key<span class="token punctuation">,</span> <span class="token keyword">const</span> Value<span class="token operator">&amp;</span> value<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token operator">%</span>_size<span class="token punctuation">;</span>
    HashNode<span class="token operator">&lt;</span>Key<span class="token punctuation">,</span> Value<span class="token operator">></span> <span class="token operator">*</span> node <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token generic-function"><span class="token function">HashNode</span><span class="token generic class-name"><span class="token operator">&lt;</span>Key<span class="token punctuation">,</span> Value<span class="token operator">></span></span></span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    node<span class="token operator">-></span>next <span class="token operator">=</span> table<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
    table<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> node<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>


<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">Key</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">Value</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">HashFunc</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">EqualKey</span><span class="token operator">></span>
<span class="token keyword">bool</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span>Key<span class="token punctuation">,</span> Value<span class="token punctuation">,</span> HashFunc<span class="token punctuation">,</span> EqualKey<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">del</span><span class="token punctuation">(</span><span class="token keyword">const</span> Key<span class="token operator">&amp;</span> key<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">unsigned</span> index <span class="token operator">=</span> <span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">%</span> _size<span class="token punctuation">;</span>
    HashNode<span class="token operator">&lt;</span>Key<span class="token punctuation">,</span> Value<span class="token operator">></span> <span class="token operator">*</span> node <span class="token operator">=</span> table<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
    HashNode<span class="token operator">&lt;</span>Key<span class="token punctuation">,</span> Value<span class="token operator">></span> <span class="token operator">*</span> prev <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>node<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token operator">-></span>_key <span class="token operator">==</span> key<span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>prev <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                table<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> node<span class="token operator">-></span>next<span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">&#123;</span>
                prev<span class="token operator">-></span>next <span class="token operator">=</span> node<span class="token operator">-></span>next<span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">delete</span> node<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        prev <span class="token operator">=</span> node<span class="token punctuation">;</span>
        node <span class="token operator">=</span> node<span class="token operator">-></span>next<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">Key</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">Value</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">HashFunc</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">EqualKey</span><span class="token operator">></span>
Value<span class="token operator">&amp;</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span>Key<span class="token punctuation">,</span> Value<span class="token punctuation">,</span> HashFunc<span class="token punctuation">,</span> EqualKey<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">const</span> Key<span class="token operator">&amp;</span> key<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">unsigned</span>  index <span class="token operator">=</span> <span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">%</span> _size<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>table<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> ValueNULL<span class="token punctuation">;</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">&#123;</span>
        HashNode<span class="token operator">&lt;</span>Key<span class="token punctuation">,</span> Value<span class="token operator">></span> <span class="token operator">*</span> node <span class="token operator">=</span> table<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>node<span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token operator">-></span>_key <span class="token operator">==</span> key<span class="token punctuation">)</span>
                <span class="token keyword">return</span> node<span class="token operator">-></span>_value<span class="token punctuation">;</span>
            node <span class="token operator">=</span> node<span class="token operator">-></span>next<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>


<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">Key</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">Value</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">HashFunc</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">EqualKey</span><span class="token operator">></span>
Value<span class="token operator">&amp;</span> HashMap<span class="token operator">&lt;</span>Key<span class="token punctuation">,</span> Value<span class="token punctuation">,</span> HashFunc<span class="token punctuation">,</span> EqualKey<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token keyword">operator</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">const</span> Key<span class="token operator">&amp;</span> key<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token function">find</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>


<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>


<span class="token comment">//é¦–å…ˆè¦å®šä¹‰hashå‡½æ•°ä¸æ¯”è¾ƒå‡½æ•°</span>
<span class="token keyword">class</span> <span class="token class-name">HashFunc</span>
<span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">const</span> string <span class="token operator">&amp;</span> key <span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">int</span> hash <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> key<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            hash <span class="token operator">=</span> hash <span class="token operator">&lt;&lt;</span> <span class="token number">7</span> <span class="token operator">^</span> key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>hash <span class="token operator">&amp;</span> <span class="token number">0x7FFFFFFF</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>


<span class="token keyword">class</span> <span class="token class-name">EqualKey</span>
<span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">const</span> string <span class="token operator">&amp;</span> A<span class="token punctuation">,</span> <span class="token keyword">const</span> string <span class="token operator">&amp;</span> B<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>A<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

æµ‹è¯•ç”¨ä¾‹
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    HashMap<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> string<span class="token punctuation">,</span> HashFunc<span class="token punctuation">,</span> EqualKey<span class="token operator">></span> <span class="token function">hashmap</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    hashmap<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">,</span> <span class="token string">"world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    hashmap<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">"why"</span><span class="token punctuation">,</span> <span class="token string">"dream"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    hashmap<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">"c++"</span><span class="token punctuation">,</span> <span class="token string">"good"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    hashmap<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">"welcome"</span><span class="token punctuation">,</span> <span class="token string">"haha"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"after insert:"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> hashmap<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"welcome"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> hashmap<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"c++"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> hashmap<span class="token punctuation">[</span><span class="token string">"why"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> hashmap<span class="token punctuation">[</span><span class="token string">"hello"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>hashmap<span class="token punctuation">.</span><span class="token function">del</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"remove is ok"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token comment">//remove is ok</span>
    cout <span class="token operator">&lt;&lt;</span> hashmap<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token comment">//not exist print NULL</span>

    hashmap<span class="token punctuation">[</span><span class="token string">"why"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"love"</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> hashmap<span class="token punctuation">[</span><span class="token string">"why"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>


<h3 id="AVL-tree"><a href="#AVL-tree" class="headerlink" title="AVL tree"></a>AVL tree</h3><pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">_AVL_TREE_HPP_</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_AVL_TREE_HPP_</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iomanip></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">class</span> <span class="token class-name">AVLTreeNode</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span><span class="token operator">:</span>
        T key<span class="token punctuation">;</span>                <span class="token comment">// å…³é”®å­—(é”®å€¼)</span>
        <span class="token keyword">int</span> height<span class="token punctuation">;</span>         <span class="token comment">// é«˜åº¦</span>
        AVLTreeNode <span class="token operator">*</span>left<span class="token punctuation">;</span>    <span class="token comment">// å·¦å­©å­</span>
        AVLTreeNode <span class="token operator">*</span>right<span class="token punctuation">;</span>    <span class="token comment">// å³å­©å­</span>

        <span class="token function">AVLTreeNode</span><span class="token punctuation">(</span>T value<span class="token punctuation">,</span> AVLTreeNode <span class="token operator">*</span>l<span class="token punctuation">,</span> AVLTreeNode <span class="token operator">*</span>r<span class="token punctuation">)</span><span class="token operator">:</span>
            <span class="token function">key</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">height</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">left</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">right</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">class</span> <span class="token class-name">AVLTree</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span><span class="token operator">:</span>
        AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token operator">*</span>mRoot<span class="token punctuation">;</span>    <span class="token comment">// æ ¹ç»“ç‚¹</span>

    <span class="token keyword">public</span><span class="token operator">:</span>
        <span class="token function">AVLTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">~</span><span class="token function">AVLTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è·å–æ ‘çš„é«˜åº¦</span>
        <span class="token keyword">int</span> <span class="token function">height</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è·å–æ ‘çš„é«˜åº¦</span>
        <span class="token keyword">int</span> <span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å‰åºéå†"AVLæ ‘"</span>
        <span class="token keyword">void</span> <span class="token function">preOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ä¸­åºéå†"AVLæ ‘"</span>
        <span class="token keyword">void</span> <span class="token function">inOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ååºéå†"AVLæ ‘"</span>
        <span class="token keyword">void</span> <span class="token function">postOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// (é€’å½’å®ç°)æŸ¥æ‰¾"AVLæ ‘"ä¸­é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹</span>
        AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token function">search</span><span class="token punctuation">(</span>T key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// (éé€’å½’å®ç°)æŸ¥æ‰¾"AVLæ ‘"ä¸­é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹</span>
        AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token function">iterativeSearch</span><span class="token punctuation">(</span>T key<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// æŸ¥æ‰¾æœ€å°ç»“ç‚¹ï¼šè¿”å›æœ€å°ç»“ç‚¹çš„é”®å€¼ã€‚</span>
        T <span class="token function">minimum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æŸ¥æ‰¾æœ€å¤§ç»“ç‚¹ï¼šè¿”å›æœ€å¤§ç»“ç‚¹çš„é”®å€¼ã€‚</span>
        T <span class="token function">maximum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å°†ç»“ç‚¹(keyä¸ºèŠ‚ç‚¹é”®å€¼)æ’å…¥åˆ°AVLæ ‘ä¸­</span>
        <span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span>T key<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// åˆ é™¤ç»“ç‚¹(keyä¸ºèŠ‚ç‚¹é”®å€¼)</span>
        <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span>T key<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// é”€æ¯AVLæ ‘</span>
        <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// æ‰“å°AVLæ ‘</span>
        <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span><span class="token operator">:</span>
        <span class="token comment">// è·å–æ ‘çš„é«˜åº¦</span>
        <span class="token keyword">int</span> <span class="token function">height</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> tree<span class="token punctuation">)</span> <span class="token punctuation">;</span>

        <span class="token comment">// å‰åºéå†"AVLæ ‘"</span>
        <span class="token keyword">void</span> <span class="token function">preOrder</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> tree<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
        <span class="token comment">// ä¸­åºéå†"AVLæ ‘"</span>
        <span class="token keyword">void</span> <span class="token function">inOrder</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> tree<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
        <span class="token comment">// ååºéå†"AVLæ ‘"</span>
        <span class="token keyword">void</span> <span class="token function">postOrder</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> tree<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>

        <span class="token comment">// (é€’å½’å®ç°)æŸ¥æ‰¾"AVLæ ‘x"ä¸­é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹</span>
        AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token function">search</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> x<span class="token punctuation">,</span> T key<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
        <span class="token comment">// (éé€’å½’å®ç°)æŸ¥æ‰¾"AVLæ ‘x"ä¸­é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹</span>
        AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token function">iterativeSearch</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> x<span class="token punctuation">,</span> T key<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>

        <span class="token comment">// æŸ¥æ‰¾æœ€å°ç»“ç‚¹ï¼šè¿”å›treeä¸ºæ ¹ç»“ç‚¹çš„AVLæ ‘çš„æœ€å°ç»“ç‚¹ã€‚</span>
        AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token function">minimum</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> tree<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æŸ¥æ‰¾æœ€å¤§ç»“ç‚¹ï¼šè¿”å›treeä¸ºæ ¹ç»“ç‚¹çš„AVLæ ‘çš„æœ€å¤§ç»“ç‚¹ã€‚</span>
        AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token function">maximum</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> tree<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// LLï¼šå·¦å·¦å¯¹åº”çš„æƒ…å†µ(å·¦å•æ—‹è½¬)ã€‚</span>
        AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token function">leftLeftRotation</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> k2<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// RRï¼šå³å³å¯¹åº”çš„æƒ…å†µ(å³å•æ—‹è½¬)ã€‚</span>
        AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token function">rightRightRotation</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> k1<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// LRï¼šå·¦å³å¯¹åº”çš„æƒ…å†µ(å·¦åŒæ—‹è½¬)ã€‚</span>
        AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token function">leftRightRotation</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> k3<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// RLï¼šå³å·¦å¯¹åº”çš„æƒ…å†µ(å³åŒæ—‹è½¬)ã€‚</span>
        AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token function">rightLeftRotation</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> k1<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å°†ç»“ç‚¹(z)æ’å…¥åˆ°AVLæ ‘(tree)ä¸­</span>
        AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token function">insert</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token operator">&amp;</span>tree<span class="token punctuation">,</span> T key<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// åˆ é™¤AVLæ ‘(tree)ä¸­çš„ç»“ç‚¹(z)ï¼Œå¹¶è¿”å›è¢«åˆ é™¤çš„ç»“ç‚¹</span>
        AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token function">remove</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token operator">&amp;</span>tree<span class="token punctuation">,</span> AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> z<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// é”€æ¯AVLæ ‘</span>
        <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token operator">&amp;</span>tree<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// æ‰“å°AVLæ ‘</span>
        <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> tree<span class="token punctuation">,</span> T key<span class="token punctuation">,</span> <span class="token keyword">int</span> direction<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">/*
 * æ„é€ å‡½æ•°
 */</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">AVLTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">mRoot</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 * ææ„å‡½æ•°
 */</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
AVLTree<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">AVLTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token function">destroy</span><span class="token punctuation">(</span>mRoot<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 * è·å–æ ‘çš„é«˜åº¦
 */</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">int</span> <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">height</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> tree<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tree <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> tree<span class="token operator">-></span>height<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">int</span> <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token function">height</span><span class="token punctuation">(</span>mRoot<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">/*
 * æ¯”è¾ƒä¸¤ä¸ªå€¼çš„å¤§å°
 */</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">int</span> <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> a<span class="token operator">></span>b <span class="token operator">?</span> a <span class="token operator">:</span> b<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 * å‰åºéå†"AVLæ ‘"
 */</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">void</span> <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">preOrder</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> tree<span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>tree <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        cout<span class="token operator">&lt;&lt;</span> tree<span class="token operator">-></span>key <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token punctuation">;</span>
        <span class="token function">preOrder</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">preOrder</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">void</span> <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">preOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token function">preOrder</span><span class="token punctuation">(</span>mRoot<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 * ä¸­åºéå†"AVLæ ‘"
 */</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">void</span> <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">inOrder</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> tree<span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>tree <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">inOrder</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>
        cout<span class="token operator">&lt;&lt;</span> tree<span class="token operator">-></span>key <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token punctuation">;</span>
        <span class="token function">inOrder</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">void</span> <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">inOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token function">inOrder</span><span class="token punctuation">(</span>mRoot<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 * ååºéå†"AVLæ ‘"
 */</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">void</span> <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">postOrder</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> tree<span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>tree <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">postOrder</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">postOrder</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>
        cout<span class="token operator">&lt;&lt;</span> tree<span class="token operator">-></span>key <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">void</span> <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">postOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token function">postOrder</span><span class="token punctuation">(</span>mRoot<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 * (é€’å½’å®ç°)æŸ¥æ‰¾"AVLæ ‘x"ä¸­é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹
 */</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">search</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> x<span class="token punctuation">,</span> T key<span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>x<span class="token operator">==</span><span class="token constant">NULL</span> <span class="token operator">||</span> x<span class="token operator">-></span>key<span class="token operator">==</span>key<span class="token punctuation">)</span>
        <span class="token keyword">return</span> x<span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">&lt;</span> x<span class="token operator">-></span>key<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token function">search</span><span class="token punctuation">(</span>x<span class="token operator">-></span>left<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        <span class="token keyword">return</span> <span class="token function">search</span><span class="token punctuation">(</span>x<span class="token operator">-></span>right<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">search</span><span class="token punctuation">(</span>T key<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token function">search</span><span class="token punctuation">(</span>mRoot<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 * (éé€’å½’å®ç°)æŸ¥æ‰¾"AVLæ ‘x"ä¸­é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹
 */</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">iterativeSearch</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> x<span class="token punctuation">,</span> T key<span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>x<span class="token operator">-></span>key<span class="token operator">!=</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">&lt;</span> x<span class="token operator">-></span>key<span class="token punctuation">)</span>
            x <span class="token operator">=</span> x<span class="token operator">-></span>left<span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            x <span class="token operator">=</span> x<span class="token operator">-></span>right<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">return</span> x<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">iterativeSearch</span><span class="token punctuation">(</span>T key<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token function">iterativeSearch</span><span class="token punctuation">(</span>mRoot<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 * æŸ¥æ‰¾æœ€å°ç»“ç‚¹ï¼šè¿”å›treeä¸ºæ ¹ç»“ç‚¹çš„AVLæ ‘çš„æœ€å°ç»“ç‚¹ã€‚
 */</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">minimum</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> tree<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tree <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>left <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        tree <span class="token operator">=</span> tree<span class="token operator">-></span>left<span class="token punctuation">;</span>
    <span class="token keyword">return</span> tree<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
T <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">minimum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token function">minimum</span><span class="token punctuation">(</span>mRoot<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> p<span class="token operator">-></span>key<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 * æŸ¥æ‰¾æœ€å¤§ç»“ç‚¹ï¼šè¿”å›treeä¸ºæ ¹ç»“ç‚¹çš„AVLæ ‘çš„æœ€å¤§ç»“ç‚¹ã€‚
 */</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">maximum</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> tree<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tree <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>right <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        tree <span class="token operator">=</span> tree<span class="token operator">-></span>right<span class="token punctuation">;</span>
    <span class="token keyword">return</span> tree<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
T <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">maximum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token function">maximum</span><span class="token punctuation">(</span>mRoot<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> p<span class="token operator">-></span>key<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 * LLï¼šå·¦å·¦å¯¹åº”çš„æƒ…å†µ(å·¦å•æ—‹è½¬)ã€‚
 *
 * è¿”å›å€¼ï¼šæ—‹è½¬åçš„æ ¹èŠ‚ç‚¹
 */</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">leftLeftRotation</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> k2<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> k1<span class="token punctuation">;</span>

    k1 <span class="token operator">=</span> k2<span class="token operator">-></span>left<span class="token punctuation">;</span>
    k2<span class="token operator">-></span>left <span class="token operator">=</span> k1<span class="token operator">-></span>right<span class="token punctuation">;</span>
    k1<span class="token operator">-></span>right <span class="token operator">=</span> k2<span class="token punctuation">;</span>

    k2<span class="token operator">-></span>height <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span> <span class="token function">height</span><span class="token punctuation">(</span>k2<span class="token operator">-></span>left<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">height</span><span class="token punctuation">(</span>k2<span class="token operator">-></span>right<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    k1<span class="token operator">-></span>height <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span> <span class="token function">height</span><span class="token punctuation">(</span>k1<span class="token operator">-></span>left<span class="token punctuation">)</span><span class="token punctuation">,</span> k2<span class="token operator">-></span>height<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> k1<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 * RRï¼šå³å³å¯¹åº”çš„æƒ…å†µ(å³å•æ—‹è½¬)ã€‚
 *
 * è¿”å›å€¼ï¼šæ—‹è½¬åçš„æ ¹èŠ‚ç‚¹
 */</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">rightRightRotation</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> k1<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> k2<span class="token punctuation">;</span>

    k2 <span class="token operator">=</span> k1<span class="token operator">-></span>right<span class="token punctuation">;</span>
    k1<span class="token operator">-></span>right <span class="token operator">=</span> k2<span class="token operator">-></span>left<span class="token punctuation">;</span>
    k2<span class="token operator">-></span>left <span class="token operator">=</span> k1<span class="token punctuation">;</span>

    k1<span class="token operator">-></span>height <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span> <span class="token function">height</span><span class="token punctuation">(</span>k1<span class="token operator">-></span>left<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">height</span><span class="token punctuation">(</span>k1<span class="token operator">-></span>right<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    k2<span class="token operator">-></span>height <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span> <span class="token function">height</span><span class="token punctuation">(</span>k2<span class="token operator">-></span>right<span class="token punctuation">)</span><span class="token punctuation">,</span> k1<span class="token operator">-></span>height<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> k2<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 * LRï¼šå·¦å³å¯¹åº”çš„æƒ…å†µ(å·¦åŒæ—‹è½¬)ã€‚
 *
 * è¿”å›å€¼ï¼šæ—‹è½¬åçš„æ ¹èŠ‚ç‚¹
 */</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">leftRightRotation</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> k3<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    k3<span class="token operator">-></span>left <span class="token operator">=</span> <span class="token function">rightRightRotation</span><span class="token punctuation">(</span>k3<span class="token operator">-></span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token function">leftLeftRotation</span><span class="token punctuation">(</span>k3<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 * RLï¼šå³å·¦å¯¹åº”çš„æƒ…å†µ(å³åŒæ—‹è½¬)ã€‚
 *
 * è¿”å›å€¼ï¼šæ—‹è½¬åçš„æ ¹èŠ‚ç‚¹
 */</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">rightLeftRotation</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> k1<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    k1<span class="token operator">-></span>right <span class="token operator">=</span> <span class="token function">leftLeftRotation</span><span class="token punctuation">(</span>k1<span class="token operator">-></span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token function">rightRightRotation</span><span class="token punctuation">(</span>k1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 * å°†ç»“ç‚¹æ’å…¥åˆ°AVLæ ‘ä¸­ï¼Œå¹¶è¿”å›æ ¹èŠ‚ç‚¹
 *
 * å‚æ•°è¯´æ˜ï¼š
 *     tree AVLæ ‘çš„æ ¹ç»“ç‚¹
 *     key æ’å…¥çš„ç»“ç‚¹çš„é”®å€¼
 * è¿”å›å€¼ï¼š
 *     æ ¹èŠ‚ç‚¹
 */</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">insert</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token operator">&amp;</span>tree<span class="token punctuation">,</span> T key<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tree <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token comment">// æ–°å»ºèŠ‚ç‚¹</span>
        tree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token generic-function"><span class="token function">AVLTreeNode</span><span class="token generic class-name"><span class="token operator">&lt;</span>T<span class="token operator">></span></span></span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>tree<span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ERROR: create avltree node failed!"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">&lt;</span> tree<span class="token operator">-></span>key<span class="token punctuation">)</span> <span class="token comment">// åº”è¯¥å°†keyæ’å…¥åˆ°"treeçš„å·¦å­æ ‘"çš„æƒ…å†µ</span>
    <span class="token punctuation">&#123;</span>
        tree<span class="token operator">-></span>left <span class="token operator">=</span> <span class="token function">insert</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>left<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æ’å…¥èŠ‚ç‚¹åï¼Œè‹¥AVLæ ‘å¤±å»å¹³è¡¡ï¼Œåˆ™è¿›è¡Œç›¸åº”çš„è°ƒèŠ‚ã€‚</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">height</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>left<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">height</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>right<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">&lt;</span> tree<span class="token operator">-></span>left<span class="token operator">-></span>key<span class="token punctuation">)</span>
                tree <span class="token operator">=</span> <span class="token function">leftLeftRotation</span><span class="token punctuation">(</span>tree<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span>
                tree <span class="token operator">=</span> <span class="token function">leftRightRotation</span><span class="token punctuation">(</span>tree<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">></span> tree<span class="token operator">-></span>key<span class="token punctuation">)</span> <span class="token comment">// åº”è¯¥å°†keyæ’å…¥åˆ°"treeçš„å³å­æ ‘"çš„æƒ…å†µ</span>
    <span class="token punctuation">&#123;</span>
        tree<span class="token operator">-></span>right <span class="token operator">=</span> <span class="token function">insert</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>right<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æ’å…¥èŠ‚ç‚¹åï¼Œè‹¥AVLæ ‘å¤±å»å¹³è¡¡ï¼Œåˆ™è¿›è¡Œç›¸åº”çš„è°ƒèŠ‚ã€‚</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">height</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>right<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">height</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>left<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">></span> tree<span class="token operator">-></span>right<span class="token operator">-></span>key<span class="token punctuation">)</span>
                tree <span class="token operator">=</span> <span class="token function">rightRightRotation</span><span class="token punctuation">(</span>tree<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span>
                tree <span class="token operator">=</span> <span class="token function">rightLeftRotation</span><span class="token punctuation">(</span>tree<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token comment">//key == tree->key)</span>
    <span class="token punctuation">&#123;</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"æ·»åŠ å¤±è´¥ï¼šä¸å…è®¸æ·»åŠ ç›¸åŒçš„èŠ‚ç‚¹ï¼"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    tree<span class="token operator">-></span>height <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span> <span class="token function">height</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>left<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">height</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>right<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> tree<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">void</span> <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">insert</span><span class="token punctuation">(</span>T key<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token function">insert</span><span class="token punctuation">(</span>mRoot<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 * åˆ é™¤ç»“ç‚¹(z)ï¼Œè¿”å›æ ¹èŠ‚ç‚¹
 *
 * å‚æ•°è¯´æ˜ï¼š
 *     tree AVLæ ‘çš„æ ¹ç»“ç‚¹
 *     z å¾…åˆ é™¤çš„ç»“ç‚¹
 * è¿”å›å€¼ï¼š
 *     æ ¹èŠ‚ç‚¹
 */</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">remove</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token operator">&amp;</span>tree<span class="token punctuation">,</span> AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> z<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token comment">// æ ¹ä¸ºç©º æˆ–è€… æ²¡æœ‰è¦åˆ é™¤çš„èŠ‚ç‚¹ï¼Œç›´æ¥è¿”å›NULLã€‚</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tree<span class="token operator">==</span><span class="token constant">NULL</span> <span class="token operator">||</span> z<span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>z<span class="token operator">-></span>key <span class="token operator">&lt;</span> tree<span class="token operator">-></span>key<span class="token punctuation">)</span>        <span class="token comment">// å¾…åˆ é™¤çš„èŠ‚ç‚¹åœ¨"treeçš„å·¦å­æ ‘"ä¸­</span>
    <span class="token punctuation">&#123;</span>
        tree<span class="token operator">-></span>left <span class="token operator">=</span> <span class="token function">remove</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>left<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åˆ é™¤èŠ‚ç‚¹åï¼Œè‹¥AVLæ ‘å¤±å»å¹³è¡¡ï¼Œåˆ™è¿›è¡Œç›¸åº”çš„è°ƒèŠ‚ã€‚</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">height</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>right<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">height</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>left<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token operator">*</span>r <span class="token operator">=</span>  tree<span class="token operator">-></span>right<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">height</span><span class="token punctuation">(</span>r<span class="token operator">-></span>left<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token function">height</span><span class="token punctuation">(</span>r<span class="token operator">-></span>right<span class="token punctuation">)</span><span class="token punctuation">)</span>
                tree <span class="token operator">=</span> <span class="token function">rightLeftRotation</span><span class="token punctuation">(</span>tree<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span>
                tree <span class="token operator">=</span> <span class="token function">rightRightRotation</span><span class="token punctuation">(</span>tree<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>z<span class="token operator">-></span>key <span class="token operator">></span> tree<span class="token operator">-></span>key<span class="token punctuation">)</span><span class="token comment">// å¾…åˆ é™¤çš„èŠ‚ç‚¹åœ¨"treeçš„å³å­æ ‘"ä¸­</span>
    <span class="token punctuation">&#123;</span>
        tree<span class="token operator">-></span>right <span class="token operator">=</span> <span class="token function">remove</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>right<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åˆ é™¤èŠ‚ç‚¹åï¼Œè‹¥AVLæ ‘å¤±å»å¹³è¡¡ï¼Œåˆ™è¿›è¡Œç›¸åº”çš„è°ƒèŠ‚ã€‚</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">height</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>left<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">height</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>right<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token operator">*</span>l <span class="token operator">=</span>  tree<span class="token operator">-></span>left<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">height</span><span class="token punctuation">(</span>l<span class="token operator">-></span>right<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token function">height</span><span class="token punctuation">(</span>l<span class="token operator">-></span>left<span class="token punctuation">)</span><span class="token punctuation">)</span>
                tree <span class="token operator">=</span> <span class="token function">leftRightRotation</span><span class="token punctuation">(</span>tree<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span>
                tree <span class="token operator">=</span> <span class="token function">leftLeftRotation</span><span class="token punctuation">(</span>tree<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span>    <span class="token comment">// treeæ˜¯å¯¹åº”è¦åˆ é™¤çš„èŠ‚ç‚¹ã€‚</span>
    <span class="token punctuation">&#123;</span>
        <span class="token comment">// treeçš„å·¦å³å­©å­éƒ½éç©º</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>left<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>tree<span class="token operator">-></span>right<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">height</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>left<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token function">height</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>right<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                <span class="token comment">// å¦‚æœtreeçš„å·¦å­æ ‘æ¯”å³å­æ ‘é«˜ï¼›</span>
                <span class="token comment">// åˆ™(01)æ‰¾å‡ºtreeçš„å·¦å­æ ‘ä¸­çš„æœ€å¤§èŠ‚ç‚¹</span>
                <span class="token comment">//   (02)å°†è¯¥æœ€å¤§èŠ‚ç‚¹çš„å€¼èµ‹å€¼ç»™treeã€‚</span>
                <span class="token comment">//   (03)åˆ é™¤è¯¥æœ€å¤§èŠ‚ç‚¹ã€‚</span>
                <span class="token comment">// è¿™ç±»ä¼¼äºç”¨"treeçš„å·¦å­æ ‘ä¸­æœ€å¤§èŠ‚ç‚¹"åš"tree"çš„æ›¿èº«ï¼›</span>
                <span class="token comment">// é‡‡ç”¨è¿™ç§æ–¹å¼çš„å¥½å¤„æ˜¯ï¼šåˆ é™¤"treeçš„å·¦å­æ ‘ä¸­æœ€å¤§èŠ‚ç‚¹"ä¹‹åï¼ŒAVLæ ‘ä»ç„¶æ˜¯å¹³è¡¡çš„ã€‚</span>
                AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> max <span class="token operator">=</span> <span class="token function">maximum</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>
                tree<span class="token operator">-></span>key <span class="token operator">=</span> max<span class="token operator">-></span>key<span class="token punctuation">;</span>
                tree<span class="token operator">-></span>left <span class="token operator">=</span> <span class="token function">remove</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>left<span class="token punctuation">,</span> max<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">&#123;</span>
                <span class="token comment">// å¦‚æœtreeçš„å·¦å­æ ‘ä¸æ¯”å³å­æ ‘é«˜(å³å®ƒä»¬ç›¸ç­‰ï¼Œæˆ–å³å­æ ‘æ¯”å·¦å­æ ‘é«˜1)</span>
                <span class="token comment">// åˆ™(01)æ‰¾å‡ºtreeçš„å³å­æ ‘ä¸­çš„æœ€å°èŠ‚ç‚¹</span>
                <span class="token comment">//   (02)å°†è¯¥æœ€å°èŠ‚ç‚¹çš„å€¼èµ‹å€¼ç»™treeã€‚</span>
                <span class="token comment">//   (03)åˆ é™¤è¯¥æœ€å°èŠ‚ç‚¹ã€‚</span>
                <span class="token comment">// è¿™ç±»ä¼¼äºç”¨"treeçš„å³å­æ ‘ä¸­æœ€å°èŠ‚ç‚¹"åš"tree"çš„æ›¿èº«ï¼›</span>
                <span class="token comment">// é‡‡ç”¨è¿™ç§æ–¹å¼çš„å¥½å¤„æ˜¯ï¼šåˆ é™¤"treeçš„å³å­æ ‘ä¸­æœ€å°èŠ‚ç‚¹"ä¹‹åï¼ŒAVLæ ‘ä»ç„¶æ˜¯å¹³è¡¡çš„ã€‚</span>
                AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> min <span class="token operator">=</span> <span class="token function">maximum</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>
                tree<span class="token operator">-></span>key <span class="token operator">=</span> min<span class="token operator">-></span>key<span class="token punctuation">;</span>
                tree<span class="token operator">-></span>right <span class="token operator">=</span> <span class="token function">remove</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>right<span class="token punctuation">,</span> min<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">&#123;</span>
            AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> tmp <span class="token operator">=</span> tree<span class="token punctuation">;</span>
            tree <span class="token operator">=</span> <span class="token punctuation">(</span>tree<span class="token operator">-></span>left<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token operator">?</span> tree<span class="token operator">-></span>left <span class="token operator">:</span> tree<span class="token operator">-></span>right<span class="token punctuation">;</span>
            <span class="token keyword">delete</span> tmp<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">return</span> tree<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">void</span> <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">remove</span><span class="token punctuation">(</span>T key<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> z<span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>z <span class="token operator">=</span> <span class="token function">search</span><span class="token punctuation">(</span>mRoot<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        mRoot <span class="token operator">=</span> <span class="token function">remove</span><span class="token punctuation">(</span>mRoot<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 * é”€æ¯AVLæ ‘
 */</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">void</span> <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">destroy</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> <span class="token operator">&amp;</span>tree<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tree<span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>tree<span class="token operator">-></span>left <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token function">destroy</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tree<span class="token operator">-></span>right <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token function">destroy</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">delete</span> tree<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">void</span> <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token function">destroy</span><span class="token punctuation">(</span>mRoot<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 * æ‰“å°"äºŒå‰æŸ¥æ‰¾æ ‘"
 *
 * key        -- èŠ‚ç‚¹çš„é”®å€¼
 * direction  --  0ï¼Œè¡¨ç¤ºè¯¥èŠ‚ç‚¹æ˜¯æ ¹èŠ‚ç‚¹;
 *               -1ï¼Œè¡¨ç¤ºè¯¥èŠ‚ç‚¹æ˜¯å®ƒçš„çˆ¶ç»“ç‚¹çš„å·¦å­©å­;
 *                1ï¼Œè¡¨ç¤ºè¯¥èŠ‚ç‚¹æ˜¯å®ƒçš„çˆ¶ç»“ç‚¹çš„å³å­©å­ã€‚
 */</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">void</span> <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">print</span><span class="token punctuation">(</span>AVLTreeNode<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">*</span> tree<span class="token punctuation">,</span> T key<span class="token punctuation">,</span> <span class="token keyword">int</span> direction<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>tree <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>direction<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>    <span class="token comment">// treeæ˜¯æ ¹èŠ‚ç‚¹</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> tree<span class="token operator">-></span>key <span class="token operator">&lt;&lt;</span> <span class="token string">" is root"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">else</span>                <span class="token comment">// treeæ˜¯åˆ†æ”¯èŠ‚ç‚¹</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> tree<span class="token operator">-></span>key <span class="token operator">&lt;&lt;</span> <span class="token string">" is "</span> <span class="token operator">&lt;&lt;</span> <span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> key <span class="token operator">&lt;&lt;</span> <span class="token string">"'s "</span>  <span class="token operator">&lt;&lt;</span> <span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>direction<span class="token operator">==</span><span class="token number">1</span><span class="token operator">?</span><span class="token string">"right child"</span> <span class="token operator">:</span> <span class="token string">"left child"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

        <span class="token function">print</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>left<span class="token punctuation">,</span> tree<span class="token operator">-></span>key<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">print</span><span class="token punctuation">(</span>tree<span class="token operator">-></span>right<span class="token punctuation">,</span>tree<span class="token operator">-></span>key<span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">void</span> <span class="token class-name">AVLTree</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>mRoot <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token function">print</span><span class="token punctuation">(</span>mRoot<span class="token punctuation">,</span> mRoot<span class="token operator">-></span>key<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span></code></pre></div></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/cpp%E8%BF%9B%E9%98%B6/2021-09-27-grpc/" rel="prev" title="grpcç®€å•ä½¿ç”¨"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">grpcç®€å•ä½¿ç”¨</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%9B%E5%A4%A7%E4%BB%B6/2021-09-22-%E5%88%86%E5%B8%83%E5%BC%8F%E5%8D%8F%E8%B0%83,%20zookeeper,%20rpc/" rel="next" title="åˆ†å¸ƒå¼åè°ƒzookeeper, RPC"><span class="post-nav-text">åˆ†å¸ƒå¼åè°ƒzookeeper, RPC</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>å¦‚æœæ‚¨æœ‰ä»»ä½•å…³äºåšå®¢å†…å®¹çš„ç›¸å…³è®¨è®ºï¼Œæ¬¢è¿å‰å¾€ <a href="https://github.com/YunYouJun/yunyoujun.github.io/discussions" target="_blank">GitHub Discussions</a> ä¸æˆ‘äº¤æµã€‚</span><br></div><div id="valine-container"></div><script>Yun.utils.getScript("https://cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js", () => {
  const valineConfig = {"enable":true,"appId":"K4LElSwpTJaHOOTTU6mNGCyr-gzGzoHsz","appKey":"x3d4Sv6rdTYOECKqkxg9r905","placeholder":"å¡«å†™é‚®ç®±ï¼Œå¯ä»¥æ”¶åˆ°å›å¤é€šçŸ¥å“¦ï½","avatar":null,"pageSize":10,"visitor":false,"highlight":true,"recordIP":false,"enableQQ":true,"meta":["nick","mail","link"],"el":"#valine-container","lang":"zh-cn"}
  valineConfig.path = "/cpp%E8%BF%9B%E9%98%B6/2021-09-25-%E5%B8%B8%E7%94%A8%E7%B1%BB%E7%9A%84%E5%AE%9E%E7%8E%B0/"
  new Valine(valineConfig)
}, window.Valine);</script></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank">èŒICPå¤‡666666å·</a></div><div class="copyright"><span>&copy; 2020 â€“ 2021 </span><a class="with-love" id="animate" target="_blank" rel="noopener" href="https://sponsors.yunyoujun.cn" title="äº‘æ¸¸å›çš„èµåŠ©è€…ä»¬"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></a><span class="author"> larry</span></div><div class="powered"><span>ç”± <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> é©±åŠ¨ v5.4.0</span><span class="footer-separator">|</span><span>ä¸»é¢˜ - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.6.3</span></div><div class="live_time"><span>æœ¬åšå®¢å·²èŒèŒå“’åœ°è¿è¡Œ</span><span id="display_live_time"></span><span class="moe-text">(â—'â—¡'â—)</span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2020-04-12T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " å¤© " + passHour + " å°æ—¶ " + passMinute + " åˆ† " + passSecond + " ç§’";
}
blog_live_time();
</script></div></footer><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#6200ee" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="æœç´¢"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script defer src="https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script><script defer src="https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script><script defer src="/js/search/algolia-search.js"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-close-line"></use></svg></span></div><div class="search-input-container"></div><div class="algolia-results"><div id="algolia-stats"></div><div id="algolia-hits"></div><div class="algolia-pagination" id="algolia-pagination"></div></div></div></div><!-- hexo injector body_end start --><script src="/js/tag-common/index.js"></script><!-- hexo injector body_end end --></body></html>