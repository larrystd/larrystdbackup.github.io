<!DOCTYPE html><html lang="zh-CN"><head><!-- hexo injector head_begin start --><link href="/css/tag-common/index.css" rel="stylesheet"/><!-- hexo injector head_begin end --><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#6200ee"><meta name="author" content="larry"><meta name="copyright" content="larry"><meta name="generator" content="Hexo 5.4.0"><meta name="theme" content="hexo-theme-yun"><title>effectivecpp:å®ç° | æ‹‰ç‘å›ã®å°çª</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.25/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_dxory92pb0h.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link class="aplayer-style-marker" rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.css"><script class="aplayer-script-marker" src="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.js" defer></script><script class="meting-script-marker" src="https://cdn.jsdelivr.net/npm/meting@1/dist/Meting.min.js" defer></script><script>document.addEventListener(
  "pjax:success",
  function() {
    if (window.aplayers) {
      loadMeting();
    }
  },
  !1
);
</script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><link rel="icon" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#6200ee"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"larrystd.github.io","root":"/","title":"æ‹‰ç‘å›ã®å°çª","version":"1.6.3","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"æœç´¢...","empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹: ${query}","hits":"æ‰¾åˆ° ${hits} æ¡ç»“æœ","hits_time":"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"algolia":{"appID":"CJXXAGRCYN","apiKey":"ae1966d2aeab22bf9335679f45d2cd9a","indexName":"my-hexo-blog","hits":{"per_page":8}},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><link rel="alternate" href="/atom.xml" title="æ‹‰ç‘å›ã®å°çª" type="application/atom+xml"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=G-1LL0D86CY9"></script><script>if (CONFIG.hostname === location.hostname) {
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-1LL0D86CY9');
}</script><script data-ad-client="ca-pub-2245427233262012" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-M9KWR9L');</script><!-- End Google Tag Manager --><meta name="description" content="æœ¬ç« åŒ…å«ä»¥ä¸‹æ¡æ¬¾ï¼š  æ¡æ¬¾26ï¼šå°½å¯èƒ½å»¶åå˜é‡å®šä¹‰å¼çš„å‡ºç°æ—¶é—´ æ¡æ¬¾27ï¼š å°½é‡å°‘åšè½¬å‹å·¥ä½œ æ¡æ¬¾28ï¼šé¿å…è¿”å›handlesæŒ‡å‘å¯¹è±¡å†…éƒ¨æˆåˆ† æ¡æ¬¾29ï¼šä¸ºâ€å¼‚å¸¸å®‰å…¨â€è€ŒåŠªåŠ›å€¼å¾— æ¡æ¬¾30ï¼šé€å½»äº†è§£inliningçš„é‡Œé‡Œå¤–å¤– æ¡æ¬¾31ï¼šå°†æ–‡ä»¶é—´çš„ç¼–è¯‘ä¾å­˜å…³ç³»é™è‡³æœ€ä½  æ¡æ¬¾26ï¼šå°½å¯èƒ½å»¶åå˜é‡å®šä¹‰å¼çš„å‡ºç°æ—¶é—´åªè¦å®šä¹‰äº†ä¸€ä¸ªå˜é‡è€Œå…¶ç±»å‹å¸¦æœ‰ä¸€ä¸ªæ„é€ å‡½æ•°å’Œææ„å‡½æ•°ï¼Œé‚£ä¹ˆå½“ç¨‹åºæ§åˆ¶æµåˆ°è¾¾è¿™ä¸ªå˜é‡å®šä¹‰å¼æ—¶">
<meta property="og:type" content="article">
<meta property="og:title" content="effectivecpp:å®ç°">
<meta property="og:url" content="https://larrystd.github.io/effective%20cpp/2021-02-15-5%E5%AE%9E%E7%8E%B0/index.html">
<meta property="og:site_name" content="æ‹‰ç‘å›ã®å°çª">
<meta property="og:description" content="æœ¬ç« åŒ…å«ä»¥ä¸‹æ¡æ¬¾ï¼š  æ¡æ¬¾26ï¼šå°½å¯èƒ½å»¶åå˜é‡å®šä¹‰å¼çš„å‡ºç°æ—¶é—´ æ¡æ¬¾27ï¼š å°½é‡å°‘åšè½¬å‹å·¥ä½œ æ¡æ¬¾28ï¼šé¿å…è¿”å›handlesæŒ‡å‘å¯¹è±¡å†…éƒ¨æˆåˆ† æ¡æ¬¾29ï¼šä¸ºâ€å¼‚å¸¸å®‰å…¨â€è€ŒåŠªåŠ›å€¼å¾— æ¡æ¬¾30ï¼šé€å½»äº†è§£inliningçš„é‡Œé‡Œå¤–å¤– æ¡æ¬¾31ï¼šå°†æ–‡ä»¶é—´çš„ç¼–è¯‘ä¾å­˜å…³ç³»é™è‡³æœ€ä½  æ¡æ¬¾26ï¼šå°½å¯èƒ½å»¶åå˜é‡å®šä¹‰å¼çš„å‡ºç°æ—¶é—´åªè¦å®šä¹‰äº†ä¸€ä¸ªå˜é‡è€Œå…¶ç±»å‹å¸¦æœ‰ä¸€ä¸ªæ„é€ å‡½æ•°å’Œææ„å‡½æ•°ï¼Œé‚£ä¹ˆå½“ç¨‹åºæ§åˆ¶æµåˆ°è¾¾è¿™ä¸ªå˜é‡å®šä¹‰å¼æ—¶">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-02-14T16:00:00.000Z">
<meta property="article:modified_time" content="2021-02-14T16:00:00.000Z">
<meta property="article:author" content="larry">
<meta property="article:tag" content="cpp">
<meta name="twitter:card" content="summary"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="æ–‡ç« ç›®å½•"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="ç«™ç‚¹æ¦‚è§ˆ"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="larry"><img width="96" loading="lazy" src="/images/avatar.jpg" alt="larry"><span class="site-author-status" title="Looking for you.">ğŸŒ‘</span></a><div class="site-author-name"><a href="/about/">larry</a></div><a class="site-name" href="/about/site.html">æ‹‰ç‘å›ã®å°çª</a><sub class="site-subtitle"></sub><div class="site-desciption">æ¯å¤©éƒ½æ˜¯æ–°çš„ä¸€å¤©å‘¢</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="é¦–é¡µ"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="å½’æ¡£"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">86</span></a></div><div class="site-state-item"><a href="/categories/" title="åˆ†ç±»"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">13</span></a></div><div class="site-state-item"><a href="/tags/" title="æ ‡ç­¾"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">42</span></a></div><a class="site-state-item hty-icon-button" href="/about/#comment" title="ç•™è¨€æ¿"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-clipboard-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="/atom.xml" title="RSS" target="_blank" style="color:orange"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-rss-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/larrystd" title="GitHub" target="_blank" style="color:#6e5494"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.zhihu.com/people/bu-qu-dou-yin-bu-gai-ming" title="çŸ¥ä¹" target="_blank" style="color:#0084FF"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-zhihu-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="Venray.Kong@outlook.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://travellings.link" title="Travelling" target="_blank" style="color:var(--hty-text-color)"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-train-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a><a class="links-item hty-icon-button" href="/girls/" title="å–œæ¬¢çš„å¥³å­©å­" style="color:hotpink"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-women-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E6%AC%BE26%EF%BC%9A%E5%B0%BD%E5%8F%AF%E8%83%BD%E5%BB%B6%E5%90%8E%E5%8F%98%E9%87%8F%E5%AE%9A%E4%B9%89%E5%BC%8F%E7%9A%84%E5%87%BA%E7%8E%B0%E6%97%B6%E9%97%B4"><span class="toc-number">1.</span> <span class="toc-text">æ¡æ¬¾26ï¼šå°½å¯èƒ½å»¶åå˜é‡å®šä¹‰å¼çš„å‡ºç°æ—¶é—´</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E6%AC%BE27%EF%BC%9A%E5%B0%BD%E9%87%8F%E5%B0%91%E5%81%9A%E8%BD%AC%E5%9E%8B%E5%B7%A5%E4%BD%9C"><span class="toc-number">2.</span> <span class="toc-text">æ¡æ¬¾27ï¼šå°½é‡å°‘åšè½¬å‹å·¥ä½œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E6%AC%BE28%EF%BC%9A%E9%81%BF%E5%85%8D%E8%BF%94%E5%9B%9EHandles%E6%8C%87%E5%90%91%E5%AF%B9%E8%B1%A1%E5%86%85%E9%83%A8%E6%88%90%E5%88%86"><span class="toc-number">3.</span> <span class="toc-text">æ¡æ¬¾28ï¼šé¿å…è¿”å›HandlesæŒ‡å‘å¯¹è±¡å†…éƒ¨æˆåˆ†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E6%AC%BE29%EF%BC%9A%E4%B8%BA%E5%BC%82%E5%B8%B8%E5%AE%89%E5%85%A8%E8%80%8C%E5%8A%AA%E5%8A%9B%E6%98%AF%E5%80%BC%E5%BE%97%E7%9A%84"><span class="toc-number">4.</span> <span class="toc-text">æ¡æ¬¾29ï¼šä¸ºå¼‚å¸¸å®‰å…¨è€ŒåŠªåŠ›æ˜¯å€¼å¾—çš„</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E6%AC%BE30%EF%BC%9A%E9%80%8F%E5%BD%BB%E4%BA%86%E8%A7%A3inlining%E7%9A%84%E9%87%8C%E9%87%8C%E5%A4%96%E5%A4%96"><span class="toc-number">5.</span> <span class="toc-text">æ¡æ¬¾30ï¼šé€å½»äº†è§£inliningçš„é‡Œé‡Œå¤–å¤–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E6%AC%BE31%EF%BC%9A%E5%B0%86%E6%96%87%E4%BB%B6%E9%97%B4%E7%9A%84%E7%BC%96%E8%AF%91%E4%BE%9D%E5%AD%98%E5%85%B3%E7%B3%BB%E9%99%8D%E8%87%B3%E6%9C%80%E4%BD%8E"><span class="toc-number">6.</span> <span class="toc-text">æ¡æ¬¾31ï¼šå°†æ–‡ä»¶é—´çš„ç¼–è¯‘ä¾å­˜å…³ç³»é™è‡³æœ€ä½</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://larrystd.github.io/effective%20cpp/2021-02-15-5%E5%AE%9E%E7%8E%B0/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="larry"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="æ‹‰ç‘å›ã®å°çª"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">effectivecpp:å®ç°<a class="post-edit-link" href="https://github.com/larrystd/larrystd.github.io/tree/hexo/source/_posts/effective cpp/2021-02-15-5å®ç°.md" target="_blank" title="ç¼–è¾‘" rel="noopener"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-edit-line"></use></svg></a></h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="åˆ›å»ºæ—¶é—´ï¼š2021-02-15 00:00:00" itemprop="dateCreated datePublished" datetime="2021-02-15T00:00:00+08:00">2021-02-15</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="æœ¬æ–‡å­—æ•°"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-file-word-line"></use></svg></span> <span title="æœ¬æ–‡å­—æ•°">4.5k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ—¶é•¿"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-timer-line"></use></svg></span> <span title="é˜…è¯»æ—¶é•¿">17m</span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/effective-cpp/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">effective cpp</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/cpp/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">cpp</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#6200ee;"><p>æœ¬ç« åŒ…å«ä»¥ä¸‹æ¡æ¬¾ï¼š</p>
<ul>
<li>æ¡æ¬¾26ï¼šå°½å¯èƒ½å»¶åå˜é‡å®šä¹‰å¼çš„å‡ºç°æ—¶é—´</li>
<li>æ¡æ¬¾27ï¼š å°½é‡å°‘åšè½¬å‹å·¥ä½œ</li>
<li>æ¡æ¬¾28ï¼šé¿å…è¿”å›handlesæŒ‡å‘å¯¹è±¡å†…éƒ¨æˆåˆ†</li>
<li>æ¡æ¬¾29ï¼šä¸ºâ€å¼‚å¸¸å®‰å…¨â€è€ŒåŠªåŠ›å€¼å¾—</li>
<li>æ¡æ¬¾30ï¼šé€å½»äº†è§£inliningçš„é‡Œé‡Œå¤–å¤–</li>
<li>æ¡æ¬¾31ï¼šå°†æ–‡ä»¶é—´çš„ç¼–è¯‘ä¾å­˜å…³ç³»é™è‡³æœ€ä½</li>
</ul>
<h3 id="æ¡æ¬¾26ï¼šå°½å¯èƒ½å»¶åå˜é‡å®šä¹‰å¼çš„å‡ºç°æ—¶é—´"><a href="#æ¡æ¬¾26ï¼šå°½å¯èƒ½å»¶åå˜é‡å®šä¹‰å¼çš„å‡ºç°æ—¶é—´" class="headerlink" title="æ¡æ¬¾26ï¼šå°½å¯èƒ½å»¶åå˜é‡å®šä¹‰å¼çš„å‡ºç°æ—¶é—´"></a>æ¡æ¬¾26ï¼šå°½å¯èƒ½å»¶åå˜é‡å®šä¹‰å¼çš„å‡ºç°æ—¶é—´</h3><p>åªè¦å®šä¹‰äº†ä¸€ä¸ªå˜é‡è€Œå…¶ç±»å‹å¸¦æœ‰ä¸€ä¸ªæ„é€ å‡½æ•°å’Œææ„å‡½æ•°ï¼Œé‚£ä¹ˆå½“ç¨‹åºæ§åˆ¶æµåˆ°è¾¾è¿™ä¸ªå˜é‡å®šä¹‰å¼æ—¶ï¼Œå°±å¾—æ‰¿å—æ„é€ æˆæœ¬ï¼›å˜é‡ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œå°±å¾—æ‰¿å—ææ„æˆæœ¬ã€‚åº”è¯¥é¿å…è¿™ç§æ•ˆç‡æ”¯å‡ºã€‚</p>
<span id="more"></span>

<pre class="language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token double-colon punctuation">::</span>string <span class="token function">encryptPassword</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> password<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
    string encrypted<span class="token punctuation">;</span>    <span class="token comment">// å®šä¹‰æ—©äº†</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>password<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> MinimumPasswordLength<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">throw</span> <span class="token function">logic_error</span><span class="token punctuation">(</span><span class="token string">"Password is too short"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">return</span> encrypted<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>   </code></pre>
<p>æ˜¾ç„¶å¦‚æœæœ‰logic_errorå¼‚å¸¸æŠ›å‡ºï¼Œencryptedæœªè¢«ä½¿ç”¨å°±è¢«ææ„ä»˜å‡ºæˆæœ¬ã€‚å› æ­¤æœ€å¥½å°†encryptedå®šä¹‰å»¶åˆ°å¼‚å¸¸å¤„ç†ä¹‹åã€‚</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// å¯¹sè¿›è¡ŒåŠ å¯†</span>
std<span class="token double-colon punctuation">::</span>string <span class="token function">encryptPassword</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> password<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>    <span class="token comment">// å¦‚ä¸Š</span>
    std<span class="token double-colon punctuation">::</span>string <span class="token function">encrypted</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// é€šè¿‡copyæ„é€ å‡½æ•°</span>
    <span class="token function">encrypt</span><span class="token punctuation">(</span>encrypted<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> encrypted<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>   </code></pre>
<p>å°½å¯èƒ½å»¶åï¼Œå…·ä½“æ¥è¯´ï¼Œå°½å¯èƒ½å»¶ååˆ°ç»™åˆå€¼å®å‚ä¸ºæ­¢ã€‚å°½å¯èƒ½ä½¿ç”¨ä¸€ä¸ªcopyæ„é€ å‡½æ•°ä»£æ›¿defaultæ„é€ å‡½æ•°+èµ‹å€¼æ“ä½œç¬¦ã€‚</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">// defaultæ„é€ å‡½æ•°+èµ‹å€¼æ“ä½œç¬¦ã€‚</span>
std<span class="token double-colon punctuation">::</span>string encrypted<span class="token punctuation">;</span>
encrypted <span class="token operator">=</span> password<span class="token punctuation">;</span>

<span class="token comment">// ä¸€ä¸ªcopy æ„é€ å‡½æ•°ï¼Œæ•ˆç‡é«˜</span>
std<span class="token double-colon punctuation">::</span>string <span class="token function">encrypted</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h3 id="æ¡æ¬¾27ï¼šå°½é‡å°‘åšè½¬å‹å·¥ä½œ"><a href="#æ¡æ¬¾27ï¼šå°½é‡å°‘åšè½¬å‹å·¥ä½œ" class="headerlink" title="æ¡æ¬¾27ï¼šå°½é‡å°‘åšè½¬å‹å·¥ä½œ"></a>æ¡æ¬¾27ï¼šå°½é‡å°‘åšè½¬å‹å·¥ä½œ</h3><p>C++ä½œä¸ºå¼ºç±»å‹è¯­è¨€ï¼Œè§„åˆ™çš„è®¾è®¡ç›®æ ‡å°±æ˜¯ä¿è¯ç±»å‹é”™è¯¯ä¸èƒ½å‘ç”Ÿã€‚ä½†æ˜¯è½¬å‹castç ´åäº†ç±»å‹ç³»ç»Ÿï¼Œå¯èƒ½å¯¼è‡´å„ç§éº»çƒ¦ã€‚C/Java/C#è¿™äº›è¯­è¨€çš„è½¬å‹æ¯”è¾ƒå¿…è¦ä¸”éš¾ä»¥é¿å…ï¼Œä¹Ÿä¸å¤ªå±é™©ï¼Œä½†C++ä¸åŒã€‚<br>è½¬å‹è¯­æ³•é€šå¸¸æœ‰ä¸‰ç§ä¸åŒçš„å½¢å¼ï¼Œå¦‚ä¸‹</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">// Cé£æ ¼çš„è½¬å‹æ“ä½œ</span>
<span class="token punctuation">(</span>T<span class="token punctuation">)</span> expression    <span class="token comment">// å°†expressionè½¬å‹ä¸ºT</span>
<span class="token comment">// å‡½æ•°é£æ ¼çš„è½¬å‹æ“ä½œ</span>
<span class="token function">T</span><span class="token punctuation">(</span>expression<span class="token punctuation">)</span>
<span class="token comment">// ä»¥ä¸‹ä¸ºæ–°å¼è½¬å‹</span>
<span class="token generic-function"><span class="token function">const_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>T<span class="token operator">></span></span></span><span class="token punctuation">(</span>expression<span class="token punctuation">)</span>
<span class="token generic-function"><span class="token function">dynamic_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>T<span class="token operator">></span></span></span> <span class="token punctuation">(</span>expression<span class="token punctuation">)</span>
<span class="token generic-function"><span class="token function">reinterpret_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>T<span class="token operator">></span></span></span> <span class="token punctuation">(</span>expression<span class="token punctuation">)</span>
<span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>T<span class="token operator">></span></span></span> <span class="token punctuation">(</span>expression<span class="token punctuation">)</span></code></pre>
<p>å››ç§æ–°å¼è½¬å‹å„æœ‰ä¸åŒçš„ç›®çš„</p>
<ul>
<li>const_castå°†å¯¹è±¡çš„å¸¸é‡æ€§è½¬é™¤ï¼Œå³constè½¬ä¸ºnon-const</li>
<li>dynamic_castä¸»è¦ç”¨æ¥æ‰§è¡Œå®‰å…¨çš„å‘ä¸‹è½¬å‹ï¼Œä»…æ”¯æŒå¤šæ€å‘ä¸‹è½¬å‹ï¼Œè¿™æ˜¯å”¯ä¸€æ— æ³•ç”±æ—§å¼è¯­æ³•æ‰§è¡Œçš„åŠ¨ä½œï¼Œä¹Ÿæ˜¯å”¯ä¸€å¯èƒ½è€—è´¹é‡å¤§è¿è¡Œæˆæœ¬çš„è½¬å‹åŠ¨ä½œã€‚</li>
<li>reinterpret_castæ‰§è¡Œä½çº§è½¬å‹ï¼Œå®é™…åŠ¨ä½œå’Œç»“æœå¯èƒ½å–å†³äºç¼–è¯‘å™¨ã€‚è¿™ç§è½¬å‹æœ‰å·¨å¤§å±é™©ï¼Œåªåœ¨ä½çº§ä»£ç ä¸­æœ‰æ‰€åº”ç”¨ã€‚</li>
<li>static_castç”¨æ¥å¼ºåˆ¶éšå¼è½¬æ¢ï¼Œä¾‹å¦‚å°†non-constè½¬æ¢æˆconstå¯¹è±¡ï¼Œintè½¬ä¸ºdoubleï¼Œä½†æ— æ³•å°†constè½¬ä¸ºnon-constã€‚</li>
</ul>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Widget</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">explicit</span> <span class="token function">Widget</span><span class="token punctuation">(</span><span class="token keyword">int</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">doSomeWork</span><span class="token punctuation">(</span><span class="token keyword">const</span> Widget<span class="token operator">&amp;</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// å‡½æ•°é£æ ¼ï¼Œä»¥ä¸€ä¸ªintè½¬ä¸ºWidgetç±»å‹</span>
<span class="token function">doSomeWork</span><span class="token punctuation">(</span><span class="token function">Widget</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// C++é£æ ¼çš„static_castï¼Œå°†intè½¬ä¸ºWidgetç±»å‹</span>
<span class="token function">doSomeWork</span><span class="token punctuation">(</span><span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>Widget<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>äº‹å®ä¸Šï¼Œä»»ä½•ä¸€ä¸ªç±»å‹è½¬æ¢ï¼Œä¸ç®¡æ˜¯é€šè¿‡è½¬å‹æ“ä½œè¿›è¡Œçš„æ˜¾å¼è½¬æ¢ï¼Œæˆ–é€šè¿‡ç¼–è¯‘å™¨å®Œæˆçš„éšå¼è½¬æ¢ï¼Œéƒ½ä¼šä»¤ç¼–è¯‘å™¨ç¼–è¯‘å‡ºä¸€äº›è¿è¡ŒæœŸæ‰§è¡Œçš„ç ã€‚<br>å°½é‡å°‘ç”¨è½¬å‹æ“ä½œï¼Œç”¨å…¶ä»–æ–¹å¼æ¥ä»£æ›¿è½¬å‹ï¼Œå°¤å…¶æ˜¯å‘ä¸‹è½¬å‹dynamic_castã€‚<br>å¦‚æœè½¬å‹æ˜¯å¿…è¦çš„ï¼Œå°†è½¬å‹éšè—åœ¨æŸä¸ªå‡½æ•°èƒŒåã€‚å®¢æˆ·éšåå¯ä»¥è°ƒç”¨è¯¥å‡½æ•°ï¼Œè€Œä¸æ˜¯å°†è½¬å‹æ”¾è¿›ä»–ä»¬çš„ä»£ç å†…ã€‚</p>
<h3 id="æ¡æ¬¾28ï¼šé¿å…è¿”å›HandlesæŒ‡å‘å¯¹è±¡å†…éƒ¨æˆåˆ†"><a href="#æ¡æ¬¾28ï¼šé¿å…è¿”å›HandlesæŒ‡å‘å¯¹è±¡å†…éƒ¨æˆåˆ†" class="headerlink" title="æ¡æ¬¾28ï¼šé¿å…è¿”å›HandlesæŒ‡å‘å¯¹è±¡å†…éƒ¨æˆåˆ†"></a>æ¡æ¬¾28ï¼šé¿å…è¿”å›HandlesæŒ‡å‘å¯¹è±¡å†…éƒ¨æˆåˆ†</h3><p>æ‰€è°“Handlesï¼Œç”¨æ¥å–å¾—æŸä¸ªå¯¹è±¡ï¼ŒæŒ‡é’ˆã€Referenceå’Œè¿­ä»£å™¨éƒ½æ˜¯Handlesã€‚è¿”å›ä¸€ä¸ªå¯¹è±¡å†…éƒ¨æˆåˆ†çš„Handleï¼Œæœ‰é™ä½å¯¹è±¡å°è£…æ€§çš„é£é™©ï¼Œç”šè‡³å¯èƒ½é€ æˆæ¶æ„ä¿®æ”¹ç§æœ‰å˜é‡ã€‚</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// è¡¨ç¤ºç‚¹çš„class</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token base-clause"><span class="token function">Point</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token class-name">x</span><span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token class-name">y</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">setX</span><span class="token punctuation">(</span><span class="token keyword">int</span> newVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> <span class="token function">setY</span><span class="token punctuation">(</span><span class="token keyword">int</span> newVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
strcut RectData <span class="token punctuation">&#123;</span>
    Point ulhc<span class="token punctuation">;</span>  <span class="token comment">// ä¸¤ä¸ªç‚¹å¯ä»¥è¡¨ç°ä¸€ä¸ªçŸ©å½¢</span>
    Point lrhc<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    Point<span class="token operator">&amp;</span> <span class="token function">upperLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> pData<span class="token operator">-></span>ulhc<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
    Point<span class="token operator">&amp;</span> <span class="token function">lowerRight</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> pData<span class="token operator">-></span>lrhc<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    std<span class="token double-colon punctuation">::</span>shared_ptr<span class="token operator">&lt;</span>RectData<span class="token operator">></span> pData<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

Point <span class="token function">coord1</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Point <span class="token function">coord2</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Rectangle <span class="token function">rec</span><span class="token punctuation">(</span>coord1<span class="token punctuation">,</span> coord2<span class="token punctuation">)</span><span class="token punctuation">;</span>
rec<span class="token punctuation">.</span><span class="token function">upperLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setX</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// ä¿®æ”¹äº†privateæˆå‘˜</span></code></pre>
<p>ä»¥ä¸Šä»£ç ï¼Œè™½ç„¶ä»¤ç»„æˆçŸ©å½¢çš„ä¸¤ä¸ªç‚¹ä¸ºprivateæˆå‘˜ï¼Œä½†publicæˆå‘˜å‡½æ•°è¿”å›äº†ç§æœ‰æˆå‘˜çš„referenceã€‚å³referenceæŒ‡å‘privateæ•°æ®ï¼Œè°ƒç”¨è€…å¯ä»¥é€šè¿‡è¿™äº›referenceæ›´æ”¹å†…éƒ¨æ•°æ®ã€‚<br>æˆå‘˜å˜é‡çš„å°è£…æ€§å¯èƒ½ç­‰äºå…¶referenceå‡½æ•°çš„è®¿é—®çº§åˆ«ã€‚æœ¬ä¾‹è™½ç„¶ulhcå£°æ˜ä¸ºprivateï¼Œä½†å®é™…ä¸Šæ˜¯publicï¼Œå› ä¸ºpublicå‡½æ•°ä¼ å‡ºäº†å®ƒä»¬çš„referenceã€‚æˆ‘ä»¬å¿…é¡»ç•™å¿ƒæˆå‘˜å‡½æ•°è¿”å›å†…éƒ¨æ•°æ®çš„handlesã€‚<br>ä¸€èˆ¬çš„ï¼Œæˆ‘ä»¬åœ¨è¿”å›å¼•ç”¨ç±»å‹åŠ ä¸Šconstã€</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">const</span> Point<span class="token operator">&amp;</span> <span class="token function">upperLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> pData<span class="token operator">-></span>ulhc<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
    <span class="token keyword">const</span> Point<span class="token operator">&amp;</span> <span class="token function">lowerRight</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> pData<span class="token operator">-></span>lrhc<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    std<span class="token double-colon punctuation">::</span>shared_ptr<span class="token operator">&lt;</span>RectData<span class="token operator">></span> pData<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span></code></pre>
<p>é€šè¿‡è¿”å›const&amp; ï¼Œå®¢æˆ·å¯ä»¥è¯»å–çŸ©å½¢çš„Pointä½†ä¸èƒ½è¿›è¡Œä¿®æ”¹ã€‚ä½†è¿™ç§æƒ…å†µä»ç„¶å¯èƒ½å¯¼è‡´handlesæ‰€æŒ‡å¯¹è±¡ä¸å­˜åœ¨ï¼Œè§æ¡jiæ¬¾21ï¼šå¿…é¡»è¿”å›å¯¹è±¡æ—¶ï¼Œåˆ«å¦„æƒ³è¿”å›å…¶referenceã€‚<br>ä»¥ä¸Šï¼šé¿å…è¿”å›handles(åŒ…æ‹¬reference,æŒ‡é’ˆï¼Œè¿­ä»£å™¨ï¼‰æŒ‡å‘å¯¹è±¡å†…éƒ¨ã€‚</p>
<h3 id="æ¡æ¬¾29ï¼šä¸ºå¼‚å¸¸å®‰å…¨è€ŒåŠªåŠ›æ˜¯å€¼å¾—çš„"><a href="#æ¡æ¬¾29ï¼šä¸ºå¼‚å¸¸å®‰å…¨è€ŒåŠªåŠ›æ˜¯å€¼å¾—çš„" class="headerlink" title="æ¡æ¬¾29ï¼šä¸ºå¼‚å¸¸å®‰å…¨è€ŒåŠªåŠ›æ˜¯å€¼å¾—çš„"></a>æ¡æ¬¾29ï¼šä¸ºå¼‚å¸¸å®‰å…¨è€ŒåŠªåŠ›æ˜¯å€¼å¾—çš„</h3><p>å‡è®¾ä¸€ä¸ªclassç”¨æ¥è¡¨ç¤ºGUIèœå•ï¼Œç”¨äºå¤šçº¿ç¨‹ç¯å¢ƒï¼Œæœ‰ä¸€ä¸ªäº’æ–¥å™¨(mutex)ä½œä¸ºå¹¶å‘æ§åˆ¶ã€‚</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">PrettyMenu</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">changeBackground</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>istream<span class="token operator">&amp;</span> imgSrc<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// æ”¹å˜èƒŒæ™¯å›¾åƒ</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    Mutex mutex<span class="token punctuation">;</span>    <span class="token comment">// äº’æ–¥å™¨</span>
    Image<span class="token operator">*</span> bgImage<span class="token punctuation">;</span>    <span class="token comment">// ç›®å‰çš„èƒŒæ™¯å›¾åƒ</span>
    <span class="token keyword">int</span> imageChanges<span class="token punctuation">;</span>    <span class="token comment">// èƒŒæ™¯å›¾åƒè¢«æ”¹å˜çš„æ¬¡æ•°</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// changeBackgroundå‡½æ•°çš„ä¸€ä¸ªå¯èƒ½å®ç°</span>
<span class="token keyword">void</span> <span class="token class-name">PrettyMenu</span><span class="token double-colon punctuation">::</span><span class="token function">changeBackground</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>istream<span class="token operator">&amp;</span> imgSrc<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token function">lock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// å–å¾—äº’æ–¥å™¨</span>
    <span class="token keyword">delete</span> bgImage<span class="token punctuation">;</span>    <span class="token comment">// å»é™¤æ—§èƒŒæ™¯</span>
    <span class="token operator">++</span>imageChanges<span class="token punctuation">;</span>
    bgImage <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Image</span><span class="token punctuation">(</span>imgSrc<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//å®‰è£…æ–°èƒŒæ™¯</span>
    <span class="token function">unlock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// é‡Šæ”¾äº’æ–¥å™¨</span></code></pre>
<p>ä¸Šè¿°ä»£ç ååˆ†ç³Ÿç³•ï¼Œå¼‚å¸¸å®‰å…¨æœ‰ä¸¤ä¸ªæ¡ä»¶ï¼Œè¯¥å‡½æ•°æ²¡æœ‰æ»¡è¶³ä»»ä½•ä¸€ä¸ª</p>
<ol>
<li><p>ä¸æ³„éœ²ä»»ä½•èµ„æºã€‚ä¸Šè¿°ä»£ç æ²¡æœ‰åšåˆ°ï¼Œä¸€æ—¦new Imageå¯¼è‡´å¼‚å¸¸ï¼Œunlockä¸ä¼šè°ƒç”¨ï¼Œäº’æ–¥å™¨å°±è¢«æ°¸è¿œæŠŠæŒã€‚</p>
</li>
<li><p>ä¸å…è®¸æ•°æ®ç ´åã€‚è‹¥new ImageæŠ›å‡ºå¼‚å¸¸ï¼ŒbgImageå°±æŒ‡å‘å·²è¢«åˆ é™¤çš„å¯¹è±¡ï¼Œä¸”imageChangesä¹Ÿè¢«ç´¯åŠ ï¼Œè¿™ä¸åˆç†ã€‚<br>è§£å†³èµ„æºæ³„éœ²é—®é¢˜ï¼Œæ¡æ¬¾13å·²ç»è®¨è®ºå¯¹è±¡ç®¡ç†èµ„æºï¼Œå°†å¯¹è±¡å»ºç«‹åœ¨æ ˆä¸Šåˆ™æ§åˆ¶æµç¦»å¼€ä»£ç æ®µåä¼šè‡ªåŠ¨è°ƒç”¨ææ„å‡½æ•°é‡Šæ”¾èµ„æºã€‚<br>å¼‚å¸¸å®‰å…¨å‡½æ•°æä¾›ä»¥ä¸‹ä¸‰ä¸ªä¿è¯ï¼š</p>
</li>
<li><p>åŸºæœ¬ä¿è¯ã€‚å¦‚æœå¼‚å¸¸è¢«æŠ›å‡ºï¼Œç¨‹åºå†…çš„ä»»ä½•äº‹ç‰©ä»ç„¶ä¿æŒåœ¨æœ‰æ•ˆçŠ¶æ€ä¸‹ï¼Œæ²¡æœ‰ä»»ä½•å¯¹è±¡å’Œæ•°æ®ç»“æ„ä¼šå› æ­¤è€Œè´¥åã€‚ç„¶è€Œç¨‹åºçš„ç°å®çŠ¶æ€å¯èƒ½æ— æ³•é¢„æ–™ï¼Œä¾‹å¦‚ä¸Šè¿°ä»£ç å¼‚å¸¸æŠ›å‡ºæ—¶ï¼ŒPrettyMenuå¯¹è±¡å¯ä»¥ç»§ç»­ä¿æŒåŸèƒŒæ™¯å›¾åƒï¼Œæˆ–å˜æˆç¼ºçœèƒŒæ™¯å›¾åƒã€‚</p>
</li>
<li><p>å¼ºçƒˆä¿è¯ã€‚è‹¥å¼‚å¸¸è¢«æŠ›å‡ºï¼Œç¨‹åºçŠ¶æ€ä¸æ”¹å˜ã€‚å³å‡½æ•°æˆåŠŸï¼Œå°±æ˜¯å®Œå…¨æˆåŠŸï¼›å¦‚æœå¤±è´¥ï¼Œç¨‹åºå›å¤åˆ°è°ƒç”¨å‡½æ•°ä¹‹å‰çš„çŠ¶æ€ã€‚</p>
</li>
<li><p>ä¸æŠ›æ·nothrowä¿è¯ï¼Œæ‰¿è¯ºç»ä¸æŠ›å‡ºå¼‚å¸¸ï¼Œæ€»æ˜¯èƒ½å®ŒæˆåŸå…ˆæ‰¿è¯ºçš„åŠŸèƒ½ã€‚ä½œç”¨äºå†…ç½®ç±»å‹çš„æ‰€æœ‰æ“ä½œéƒ½æä¾›nothrowä¿è¯ï¼Œè¿™æ˜¯å¼‚å¸¸å®‰å…¨ç ä¸€ä¸ªå…³é”®åŸºç¡€ææ–™ã€‚ä½†è¿™ä¸ªä¿è¯å¯¹å¤§éƒ¨åˆ†å‡½æ•°æ¥è¯´ä¸ç°å®ã€‚<br>å¼‚å¸¸å®‰å…¨å¿…é¡»æä¾›ä¸Šè¿°ä¸‰ç§ä¿è¯ä¹‹ä¸€ï¼Œå¦åˆ™å®ƒå°±ä¸å…·æœ‰å¼‚å¸¸å®‰å…¨æ€§ã€‚æ˜¾ç„¶nothrowä¿è¯å¾ˆéš¾ï¼Œå¤§éƒ¨åˆ†å‡½æ•°æŠ‰æ‹©å¾€å¾€åœ¨åŸºæœ¬ä¿è¯å’Œå¼ºçƒˆä¿è¯ä¹‹é—´ã€‚<br>å¯¹changeBackgroundè€Œè¨€ï¼Œæä¾›å¼ºçƒˆä¿è¯ä¸å›°éš¾ã€‚é¦–å…ˆå°†bgImageæˆå‘˜å˜é‡ä»ç±»å‹ä¸ºImage*çš„å†…ç½®æŒ‡é’ˆæ”¹ä¸ºä¸€ä¸ªç”¨äºèµ„æºç®¡ç†çš„æ™ºèƒ½æŒ‡é’ˆã€‚ç„¶åæ’åˆ—è¯­å¥æ¬¡æ•°ï¼Œä½¿å¾—æ›´æ–°å›¾åƒä¹‹åå†ç´¯åŠ imageChanges</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">PrettyMenu</span> <span class="token punctuation">&#123;</span>
    std<span class="token double-colon punctuation">::</span>shared_ptr<span class="token operator">&lt;</span>Image<span class="token operator">></span> bgImage<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token class-name">PrettyMenu</span><span class="token double-colon punctuation">::</span><span class="token function">changeBackground</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>istream<span class="token operator">&amp;</span> imgSrc<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    Lock <span class="token function">m1</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// ç”¨å¯¹è±¡ç®¡ç†èµ„æº</span>
    bgImage<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">Image</span><span class="token punctuation">(</span>imgSrc<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// æ™ºèƒ½æŒ‡é’ˆç»´æŠ¤</span>
    <span class="token operator">++</span>imageChanges<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>
<p>ä½†ä»¥ä¸Šä¸è¶³çš„æ˜¯å‚æ•°imgSrcï¼Œè‹¥Imageæ„é€ å‡½æ•°æŠ›å‡ºå¼‚å¸¸ï¼Œå†è§£å†³è¿™ä¸ªé—®é¢˜ä¹‹å‰changeBackgroundåªèƒ½æä¾›åŸºæœ¬çš„å¼‚å¸¸å®‰å…¨ä¿è¯ã€‚<br>copy and swapç­–ç•¥å¯ä»¥å®ç°å¼‚å¸¸çš„å¼ºçƒˆä¿è¯ï¼ŒåŸåˆ™ï¼šä¸ºä½ æ‰“ç®—ä¿®æ”¹çš„å¯¹è±¡åšå‡ºä¸€ä»½å‰¯æœ¬ï¼Œç„¶ååœ¨å‰¯æœ¬ä¸Šåšä¸€åˆ‡å¿…è¦ä¹‹ä¿®æ”¹ï¼Œè‹¥ä¿®æ”¹æˆåŠŸå°†å‰¯æœ¬å’ŒåŸå¯¹è±¡åœ¨ä¸æŠ›å‡ºå¼‚å¸¸ä¸‹è¿›è¡Œswapï¼ˆåªéœ€è¦ä»¤æŒ‡é’ˆæŒ‡å‘å‰¯æœ¬ï¼‰ï¼Œè‹¥ä¿®æ”¹å¤±è´¥åŸå¯¹è±¡ä»ç„¶ä¿æŒæœªæ”¹å˜çŠ¶æ€ã€‚<br>å¯¹PrettyMenuè€Œè¨€ï¼Œcopy and swapå…¸å‹å†™æ³•å¦‚ä¸‹</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">struct</span> <span class="token class-name">PMImpl</span> <span class="token punctuation">&#123;</span>
    std<span class="token double-colon punctuation">::</span>shared_ptr<span class="token operator">&lt;</span>Image<span class="token operator">></span> bgImage<span class="token punctuation">;</span>
    <span class="token keyword">int</span> imageChanges<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">PrettyMenu</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    Mutex mutex<span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>shared_ptr<span class="token operator">&lt;</span>PMImpl<span class="token operator">></span> pImpl<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token class-name">PrettyMenu</span><span class="token double-colon punctuation">::</span><span class="token function">changeBackground</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>istream<span class="token operator">&amp;</span> imgSrc<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>swap<span class="token punctuation">;</span>
    Lock <span class="token function">m1</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>shared_ptr<span class="token operator">&lt;</span>PMImpl<span class="token operator">></span> <span class="token function">pNew</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">PMImpl</span><span class="token punctuation">(</span><span class="token operator">*</span>pImpl<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// è·å¾—ä¸€ä¸ªå‰¯æœ¬</span>
    pNew<span class="token operator">-></span>bgImage<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">Image</span><span class="token punctuation">(</span>imageSrc<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// ä¿®æ”¹å‰¯æœ¬</span>
    <span class="token operator">++</span>pNew<span class="token operator">-></span>imageChanges<span class="token punctuation">;</span>
    
    <span class="token function">swap</span><span class="token punctuation">(</span>pImpl<span class="token punctuation">,</span> pNew<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// ç½®æ¢æ•°æ®</span>
<span class="token punctuation">&#125;</span>   </code></pre>
<p>ä»¤PMImplä¸ºstructå› ä¸ºå…¶å°è£…æ€§å·²ç»ç”±pImplä¸ºprivateè€Œå¾—åˆ°äº†ä¿è¯ã€‚<br>ä½†ç”±äºè¿å¸¦å½±å“ï¼Œcopy-and-swapä¸èƒ½ä¿è¯æ•´ä¸ªå‡½æ•°å…·æœ‰å¼ºçƒˆçš„å®‰å…¨æ€§</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">someFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>
<p>æ˜¾ç„¶å¦‚æœf2()æ‰§è¡Œäº†æŸæ“ä½œå‘ç”Ÿå¼‚å¸¸ï¼Œäº‹å®ä¸Šå¾ˆéš¾æ¢å¤åŸçŠ¶ï¼Œå› ä¸ºå­˜åœ¨f1()çš„æ‰§è¡Œã€‚è€Œä¸”ï¼Œå¦‚æœf1()ä½¿æŸä¸ªæ•°æ®åº“è¢«æ”¹åŠ¨äº†ï¼Œå› ä¸ºæ•°æ®åº“å…¶ä»–å®¢æˆ·å¯èƒ½å·²ç»çœ‹åˆ°è¿™ç¬”æ•°æ®ï¼Œå¾ˆéš¾æ¢å¤åŸçŠ¶ã€‚ä¸”copy-and-swapéœ€è¦æ”¯å‡ºä¸€ä¸ªå‰¯æœ¬çš„æ—¶é—´å’Œç©ºé—´ã€‚å½“å¼ºçƒˆä¿è¯ä¸åˆ‡å®é™…æ—¶ï¼Œä½ å°±å¿…é¡»æä¾›å¼‚å¸¸åŸºæœ¬ä¿è¯ã€‚<br>æ³¨æ„ï¼šå¦‚æœç³»ç»Ÿå†…ç”±ä¸€ä¸ªå‡½æ•°ä¸å…·å¤‡å¼‚å¸¸å®‰å…¨æ€§ï¼Œæ•´ä¸ªç³»ç»Ÿå°±ä¸å…·å¤‡å¼‚å¸¸å®‰å…¨æ€§ã€‚ä¸€ä¸ªè½¯ä»¶ç³»ç»Ÿè¦ä¹ˆå…·å¤‡å¼‚å¸¸å®‰å…¨æ€§ï¼Œè¦ä¹ˆå°±ä¸å…·å¤‡ã€‚äº‹å®ä¸Šè®¸å¤šè€æ—§C++ä»£ç å¹¶ä¸å…·å¤‡å¼‚å¸¸å®‰å…¨æ€§ï¼Œå› æ­¤ä»Šå¤©å¾ˆå¤šç³»ç»Ÿä»ç„¶ä¸èƒ½è¯´æ˜¯å¼‚å¸¸å®‰å…¨çš„ã€‚</p>
<h3 id="æ¡æ¬¾30ï¼šé€å½»äº†è§£inliningçš„é‡Œé‡Œå¤–å¤–"><a href="#æ¡æ¬¾30ï¼šé€å½»äº†è§£inliningçš„é‡Œé‡Œå¤–å¤–" class="headerlink" title="æ¡æ¬¾30ï¼šé€å½»äº†è§£inliningçš„é‡Œé‡Œå¤–å¤–"></a>æ¡æ¬¾30ï¼šé€å½»äº†è§£inliningçš„é‡Œé‡Œå¤–å¤–</h3><p>Inlineå‡½æ•°ï¼Œçœ‹èµ·æ¥åƒå‡½æ•°ï¼ŒåŠ¨ä½œåƒå‡½æ•°ï¼Œæ¯”å®å¥½å¾—å¤š ã€‚è°ƒç”¨å®ƒä»¬åˆä¸éœ€è¦è’™å—å‡½æ•°è°ƒç”¨æ‰€æ‹›è‡´çš„é¢å¤–å¼€é”€ã€‚<br>è€Œä¸”ï¼Œç¼–è¯‘å™¨æœ€ä¼˜åŒ–æœºåˆ¶é€šå¸¸è¢«è®¾è®¡ç”¨æ¥æµ“ç¼©é‚£äº›â€œä¸å«å‡½æ•°è°ƒç”¨â€çš„ä»£ç ï¼Œå¯¹inlineå‡½æ•°ç¼–è¯‘å™¨èƒ½æ‰§è¡Œæ›´å¥½çš„è¯­å¢ƒç›¸å…³æœ€ä¼˜åŒ–ã€‚<br>inlineä¼šå¢åŠ ç›®æ ‡ç å¤§å°ï¼Œç¨‹åºä½“ç§¯å¤ªå¤§ï¼Œè¿™æ˜¯inlineå‡½æ•°çš„æ³¨æ„ç¼ºç‚¹ã€‚<br>inlineåªæ˜¯å¯¹ç¼–è¯‘å™¨çš„ä¸€ä¸ªç”³è¯·ï¼Œä¸æ˜¯å¼ºåˆ¶å‘½ä»¤ã€‚å¯ä»¥éšå–»æŒ‡å‡ºï¼Œä¹Ÿå¯ä»¥æ˜ç¡®æŒ‡å‡ºã€‚éšå–»æ–¹å¼æ˜¯å°†å‡½æ•°å®šä¹‰åœ¨classå®šä¹‰å¼å†…ã€‚</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">// éšå–»inline, classå®šä¹‰å¼å‡½æ•°</span>
<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> <span class="token function">age</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> theAge<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">int</span> theAge<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">// æ˜¾å¼inline</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">inline</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span> std<span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> a<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span> b<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span> <span class="token keyword">return</span> a <span class="token operator">&lt;</span> b <span class="token operator">?</span> b <span class="token operator">:</span> a<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></code></pre>
<p>æ²¡é”™ï¼Œclasså®šä¹‰å¼ä¸­çš„å‡½æ•°å°±æ˜¯inlineå‡½æ•°ã€‚å¦ä¸€ç»„è‡ªç„¶æ˜¯å…³é”®å­—Inlineæ˜ç¡®æŒ‡å‡ºã€‚<br>Inlineå‡½æ•°é€šå¸¸ç½®äºå¤´æ–‡ä»¶å†…ï¼Œå› ä¸ºå¤§å¤šæ•°æ„å»ºç¯å¢ƒåœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­è¿›è¡Œinlineã€‚Templateé€šå¸¸ä¹Ÿç½®äºå¤´æ–‡ä»¶ä¸­ï¼Œå› ä¸ºå®ƒä¸€æ—¦è¢«è°ƒç”¨ï¼Œç¼–è¯‘å™¨ä¸ºäº†å…·ç°åŒ–ï¼Œéœ€è¦çŸ¥é“å®ƒé•¿ä»€ä¹ˆæ ·å­ã€‚ä½†Templateçš„å…·ç°åŒ–ä¸inliningæ— å…³ã€‚<br>inlineæ˜¯ä¸ªç”³è¯·ï¼Œå¤§å¤šæ•°ç¼–è¯‘å™¨æ‹’ç»å°†å¤ªè¿‡å¤æ‚ï¼ˆä¾‹å¦‚å¸¦æœ‰å¾ªç¯å’Œé€’å½’ï¼‰çš„å‡½æ•°inlineï¼ŒåŒæ—¶virtualå‡½æ•°ä¹Ÿä¸ä¼šinlineï¼Œå› ä¸ºvirtualæ„å‘³ç€è¿è¡ŒæœŸæ‰ç¡®å®šè°ƒç”¨å“ªä¸ªå‡½æ•°ã€‚inlineæ˜¯ç¼–è¯‘æœŸè¡Œä¸ºã€‚ä¸€èˆ¬ç¼–è¯‘å™¨æ‹’ç»Inlineåç»™å‡ºä¸€ä¸ªè­¦å‘Šä¿¡æ¯ã€‚<br>å€˜è‹¥ä½¿ç”¨ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆå–æŸä¸ªinlineå‡½æ•°çš„åœ°å€ï¼Œinlineå‡½æ•°ä¸ä¼šè¢«Inlineã€‚åŸå› å¾ˆç®€å•ï¼Œinlineåçš„å‡½æ•°ä¸ç‹¬ç«‹å­˜åœ¨ï¼Œè‡ªç„¶æ— æ³•å–åœ°å€</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span> 
<span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>pf<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> f<span class="token punctuation">;</span>    <span class="token comment">// å‡½æ•°æŒ‡é’ˆpfæŒ‡å‘f</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//è¿™ä¸ªè°ƒç”¨ä¼šè¢«Inline,æ­£å¸¸è°ƒç”¨</span>
<span class="token function">pf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// è¿™ä¸ªè°ƒç”¨ä¸è¢«inlineï¼Œå› ä¸ºé€šè¿‡å‡½æ•°æŒ‡é’ˆå–åœ°å€è¾¾æˆ</span></code></pre>
<p>æ„é€ å‡½æ•°å’Œææ„å‡½æ•°ä¸åº”è¯¥è¢«è®¾ç½®ä¸ºinlineï¼Œå› ä¸ºç¼–è¯‘å™¨å¾€å¾€ä¼šåœ¨å…¶å†…æ·»åŠ å¾ˆå¤šå†…å®¹ï¼Œäº‹å®ä¸Šæ„é€ å‡½æ•°å’Œææ„å‡½æ•°æ˜¯å†…å®¹åºå¤§çš„å‡½æ•°ã€‚<br>ç»¼ä¸Šï¼Œåº”è¯¥å°†inlineé™åˆ¶åœ¨å°å‹ï¼Œè¢«é¢‘ç¹è°ƒç”¨çš„å‡½æ•°èº«ä¸Šï¼Œè¿™å¯ä½¿æ—¥åçš„è°ƒè¯•è¿‡ç¨‹æ›´å®¹æ˜“ï¼Œæ½œåœ¨çš„ä»£ç è†¨èƒ€é—®é¢˜æœ€å°åŒ–ï¼Œé€Ÿåº¦æå‡æœ€å¤§åŒ–ã€‚å¹³å‡è€Œè¨€ä¸€ä¸ªç¨‹åºå¾€å¾€å°†80%çš„æ‰§è¡Œæ—¶é—´èŠ±è´¹åœ¨20%çš„ä»£ç ä¸Šé¢ï¼Œä½œä¸ºä¸€ä¸ªè½¯ä»¶å¼€å‘è€…ï¼Œç›®æ ‡æ˜¯æ‰¾å‡ºè¿™20%ä»£ç ï¼Œå°½é‡èƒ½ç”¨inlineå°†å®ƒä»¬ç˜¦èº«ï¼ˆå¾ªç¯é€’å½’ç­‰é™¤å¤–ï¼‰ã€‚</p>
<h3 id="æ¡æ¬¾31ï¼šå°†æ–‡ä»¶é—´çš„ç¼–è¯‘ä¾å­˜å…³ç³»é™è‡³æœ€ä½"><a href="#æ¡æ¬¾31ï¼šå°†æ–‡ä»¶é—´çš„ç¼–è¯‘ä¾å­˜å…³ç³»é™è‡³æœ€ä½" class="headerlink" title="æ¡æ¬¾31ï¼šå°†æ–‡ä»¶é—´çš„ç¼–è¯‘ä¾å­˜å…³ç³»é™è‡³æœ€ä½"></a>æ¡æ¬¾31ï¼šå°†æ–‡ä»¶é—´çš„ç¼–è¯‘ä¾å­˜å…³ç³»é™è‡³æœ€ä½</h3><p>C++å¹¶æ²¡æœ‰æŠŠâ€œå°†æ¥å£ä»å®ç°ä¸­åˆ†ç¦»â€è¿™ä»¶äº‹åšå¾—å¾ˆå¥½ï¼Œå¦‚ä¸‹</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> name<span class="token punctuation">,</span> <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> birthday<span class="token punctuation">,</span> <span class="token keyword">const</span> Address<span class="token operator">&amp;</span> addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>string <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>string <span class="token function">birthDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>string <span class="token function">address</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    std<span class="token double-colon punctuation">::</span>string theName<span class="token punctuation">;</span>
    Date theBirthDate<span class="token punctuation">;</span>
    Address theAddress<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span></code></pre>
<p>ä»¥ä¸Šclass Personæ— æ³•é€šè¿‡ç¼–è¯‘ï¼Œå› ä¸ºç¼–è¯‘å™¨æ²¡æœ‰å–å¾—å®ç°ä»£ç ç”¨åˆ°çš„class string,Dateå’ŒAddressçš„å®šä¹‰å¼ã€‚è¿™äº›å®šä¹‰å¼å¸¸å¸¸ç”±#includeæŒ‡ç¤ºç¬¦æä¾›ï¼Œä»¥ä¸‹</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"date.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"address.h"</span></span></code></pre>
<p>ç„¶è€Œè¿™ä¹ˆä»¥æ¥ï¼ŒPersonå®šä¹‰æ–‡ä»¶å’Œå«å…¥æ–‡ä»¶ä¹‹é—´å½¢æˆäº†ä¸€ç§ç¼–è¯‘ä¾å­˜å…³ç³»ã€‚å¦‚æœå¤´æ–‡ä»¶å‘ç”Ÿæ”¹å˜ï¼Œé‚£ä¹ˆæ¯ä¸€ä¸ªå«å…¥å¤´æ–‡ä»¶çš„æ–‡ä»¶å¿…é¡»é‡æ–°ç¼–è¯‘ã€‚è¿™ç§ç¼–è¯‘ä¾èµ–ä¼šé€ æˆéš¾ä»¥å½¢å®¹çš„ç¾éš¾ã€‚<br>è§£å†³åŠæ³•æ˜¯æŠŠPersonåˆ†å‰²æˆä¸¤ä¸ªclassï¼Œä¸€ä¸ªè´Ÿè´£æä¾›æ¥å£ï¼Œä¸€ä¸ªè´Ÿè´£å®ç°æ¥å£ã€‚ä¸€èˆ¬çš„ï¼Œå¤–ç•Œä½¿ç”¨classæ—¶åªéœ€è¦inlcudeæ¥å£ã€‚</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory></span></span>
<span class="token keyword">class</span> <span class="token class-name">PersonImpl</span><span class="token punctuation">;</span>    <span class="token comment">// Personå®ç°ç±»çš„å‰ç½®å£°æ˜</span>
<span class="token keyword">class</span> <span class="token class-name">Date</span><span class="token punctuation">;</span>    <span class="token comment">// Personæ¥å£ç”¨åˆ°çš„classçš„å‰ç½®å£°æ˜</span>
<span class="token keyword">class</span> <span class="token class-name">Address</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> name<span class="token punctuation">,</span> <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> birthday<span class="token punctuation">,</span> <span class="token keyword">const</span> Address<span class="token operator">&amp;</span> addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>string <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>string <span class="token function">birthDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>string <span class="token function">address</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    std<span class="token double-colon punctuation">::</span>shared_ptr<span class="token operator">&lt;</span>PersonImpl<span class="token operator">></span> pImpl<span class="token punctuation">;</span>    <span class="token comment">// æŒ‡é’ˆï¼ŒæŒ‡å‘å®ç°çš„å¯¹è±¡</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span></code></pre>
<p>è¿™é‡ŒPersonç±»åªå«æœ‰ä¸€ä¸ªæŒ‡é’ˆæˆå‘˜ï¼ŒæŒ‡å‘å…¶å®ç°ç±»ã€‚ä¹‹æ‰€ä»¥ä½¿ç”¨æŒ‡é’ˆå› ä¸ºC++å¿…é¡»çŸ¥é“Personçš„å¤§å°ï¼Œè€ŒæŒ‡é’ˆå¤§å°ç¡®å®šä½†å¯¹è±¡å¤§å°ä¸èƒ½åœ¨è¯¥æ–‡ä»¶ä¸­ç¡®å®šã€‚è¿™ç§è®¾è®¡ç§°ä¹‹ä¸ºpimpl idiom(pointer to implementation)ã€‚<br>åœ¨è¿™ç§è®¾è®¡ä¸‹ï¼ŒPersonçš„å®¢æˆ·å®Œå…¨ä¸Date Address Personçš„å®ç°ç»†ç›®åˆ†ç¦»ï¼ŒPersonå®ç°ç±»çš„ä»»ä½•ä¿®æ”¹éƒ½ä¸éœ€è¦Personå®¢æˆ·ç«¯çš„é‡æ–°ç¼–è¯‘ã€‚å®¢æˆ·æ— æ³•çœ‹åˆ°Personçš„å…·ä½“å®ç°ï¼Œæ›´ä¸å¯èƒ½å†™å‡ºä¾èµ–å…·ä½“å®ç°çš„ä»£ç ï¼ŒçœŸæ­£çš„â€œæ¥å£ä¸å®ç°åˆ†ç¦»â€<br>ç¼–è¯‘ä¾å­˜æœ€å°åŒ–çš„æœ¬è´¨ï¼šç°å®ä¸­è®©å¤´æ–‡ä»¶å°½å¯èƒ½è‡ªæˆ‘æ»¡è¶³ï¼Œä¸‡ä¸€åšä¸åˆ°ï¼Œåˆ™è®©å®ƒä¸å…¶ä»–æ–‡ä»¶å†…çš„å£°æ˜å¼ï¼ˆè€Œéå®šä¹‰å¼ï¼‰ç›¸ä¾ã€‚ç­–ç•¥è¦æ±‚å¦‚ä¸‹ï¼š</p>
</li>
<li><p>å¦‚æœä½¿ç”¨object referenceæˆ–object pointerå¯ä»¥å®Œæˆä»»åŠ¡ï¼Œå°±ä¸è¦ä½¿ç”¨objectã€‚å¯ä»¥åªé ç±»å‹å£°æ˜å¼å®šä¹‰å‡ºæŒ‡å‘è¯¥ç±»å‹çš„referenceå’Œpointerï¼Œä½†å¦‚æœå®šä¹‰objectå°±éœ€è¦å®šä¹‰å¼ã€‚</p>
</li>
<li><p>å¦‚æœèƒ½å¤Ÿï¼Œå°½é‡ä»¥classå£°æ˜å¼æ›¿æ¢classå®šä¹‰å¼ã€‚å½“å£°æ˜ä¸€ä¸ªå‡½æ•°è€Œç”¨åˆ°æŸä¸ªclassæ—¶ï¼Œå¹¶ä¸éœ€è¦classçš„å®šä¹‰ã€‚</p>
</li>
</ol>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Date</span><span class="token punctuation">;</span>    <span class="token comment">// classå£°æ˜å¼</span>
Date <span class="token function">today</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// åªéœ€è¦å£°æ˜å¼å³å¯</span>
<span class="token keyword">void</span> <span class="token function">clearAppointments</span><span class="token punctuation">(</span>Date d<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// åŒæ ·åªéœ€è¦å£°æ˜å¼</span></code></pre>
<p>å£°æ˜today()å‡½æ•°å’ŒclearAppointments()å‡½æ•°æ— éœ€å®šä¹‰Dateï¼Œä½†ä¸€æ—¦è°ƒç”¨è¿™äº›å‡½æ•°ï¼Œè°ƒç”¨ä¹‹å‰Dateå®šä¹‰å¼éœ€è¦æ›å…‰ã€‚</p>
<ol>
<li>ä¸ºå£°æ˜å¼å’Œå®šä¹‰å¼æä¾›ä¸åŒçš„å¤´æ–‡ä»¶<br>å£°æ˜å¼å¤´æ–‡ä»¶å’Œå®šä¹‰å¼å¤´æ–‡ä»¶å¿…é¡»ä¿æŒä¸€è‡´æ€§ï¼Œå®¢æˆ·åªéœ€è¦#includeä¸€ä¸ªå£°æ˜æ–‡ä»¶è€Œæ— éœ€å‰ç½®å£°æ˜è‹¥å¹²å‡½æ•°ã€‚<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"datewfd.h"</span>    <span class="token comment">// è¿™ä¸ªå¤´æ–‡ä»¶å†…å£°æ˜ä½†æœªå®šä¹‰class Date</span></span>
Date <span class="token function">today</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">clearAppointments</span><span class="token punctuation">(</span>Date d<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
ä¸ºäº†è®¿é—®å…¶ä»–ç¼–è¯‘å•å…ƒï¼ˆå¦‚å¦ä¸€ä»£ç æ–‡ä»¶ï¼‰ä¸­çš„å˜é‡æˆ–å¯¹è±¡ï¼Œå¯¹æ™®é€šç±»å‹ï¼ˆåŒ…æ‹¬åŸºæœ¬æ•°æ®ç±»ã€ç»“æ„å’Œç±»ï¼‰ï¼Œå¯ä»¥åˆ©ç”¨å…³é”®å­—externï¼Œæ¥ä½¿ç”¨è¿™äº›å˜é‡æˆ–å¯¹è±¡æ—¶ï¼›å¯¹æ¨¡æ¿ç±»å‹ï¼Œåˆ™å¿…é¡»åœ¨å®šä¹‰è¿™äº›æ¨¡æ¿ç±»å¯¹è±¡å’Œæ¨¡æ¿å‡½æ•°æ—¶ï¼Œä½¿ç”¨æ ‡å‡†C++æ–°å¢åŠ çš„å…³é”®å­—exportï¼ˆå¯¼å‡º/å‡ºå£/è¾“å‡ºï¼‰ã€‚</li>
</ol>
<p>åƒPersonè¿™æ ·ä½¿ç”¨pimpl idiomçš„classï¼Œç§°ä¸ºHandle classã€‚ä½¿ç”¨Personç±»éœ€è¦å°†å…¶æ‰€æœ‰å‡½æ•°è¡Œä¸ºè½¬äº¤ç»™å®ç°ç±»PersonImplã€‚å®ç°Personç±»æ—¶éœ€è¦åŒæ—¶includeæ¥å£ç±»å’Œå®ç°æ¥å£ç±»</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Person.h"</span>    <span class="token comment">// include Person classå®šä¹‰å¼</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"PersonImpl.h"</span>    <span class="token comment">// å®ç°ç±»</span></span>
<span class="token class-name">Person</span><span class="token double-colon punctuation">::</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> name<span class="token punctuation">,</span> <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> birthday<span class="token punctuation">,</span> <span class="token keyword">const</span> Address<span class="token operator">&amp;</span> addr<span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token function">pImpl</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">PersonImpl</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> birthday<span class="token punctuation">,</span> addr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
std<span class="token double-colon punctuation">::</span>string <span class="token class-name">Person</span><span class="token double-colon punctuation">::</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> pImpl<span class="token operator">-></span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>
<p>ä»¥ä¸ŠPersonæ„é€ å‡½æ•°è°ƒç”¨new PersonImplæ„é€ ï¼Œä»¥åŠé€šè¿‡Person::name()å®é™…è°ƒç”¨ PersonImpl::nameã€‚</p>
<p>å¦ä¸€ç§åˆ¶ä½œHandle classçš„åŠæ³•æ˜¯ï¼Œä»¤Personæˆä¸ºä¸€ç§ç‰¹æ®Šçš„abstract base class(æŠ½è±¡åŸºç±»),ç§°ä¸ºinterface classã€‚è¿™ç§classç”¨æ¥æè¿°derived classçš„æ¥å£ï¼Œå› æ­¤é€šå¸¸ä¸å¸¦æˆå‘˜å˜é‡ï¼Œä¹Ÿæ²¡æœ‰æ„é€ å‡½æ•°ï¼Œåªæœ‰ä¸€ä¸ªvirtualææ„å‡½æ•°ä»¥åŠä¸€ç»„pure virtualå‡½æ•°ã€‚</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> std<span class="token double-colon punctuation">::</span>string <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> std<span class="token double-colon punctuation">::</span>string <span class="token function">birthDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> std<span class="token double-colon punctuation">::</span>string <span class="token function">address</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span></code></pre>
<p>æ˜¾ç„¶å¿…é¡»ä»¥Personçš„pointeræˆ–referenceæ¥æ’°å†™åº”ç”¨ç¨‹åºï¼Œå› ä¸ºä¸å¯èƒ½é’ˆå¯¹å†…æ¶µpure virtualå‡½æ•°çš„Person classå…·ç°å‡ºå®ä½“ã€‚é™¤äº†interfaceçš„æ¥å£è¢«ä¿®æ”¹å¦åˆ™å®¢æˆ·ä¸éœ€è¦é‡æ–°ç¼–è¯‘ã€‚<br>interface classé€šå¸¸é€šè¿‡å·¥å‚å‡½æ•°ï¼Œè¿”å›æŒ‡é’ˆæŒ‡å‘åŠ¨æ€åˆ†é…æ‰€å¾—å¯¹è±¡ã€‚è¿™ç§å‡½æ•°å¾€å¾€è¢«å£°æ˜ä¸ºstatic</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">// å®ç°ç±»</span>
<span class="token keyword">class</span> <span class="token class-name">RealPerson</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Person</span></span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">RealPerson</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> name<span class="token punctuation">,</span> <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> birthday<span class="token punctuation">,</span> <span class="token keyword">const</span> Address<span class="token operator">&amp;</span> addr<span class="token punctuation">)</span>
        <span class="token function">theName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">theBirthDate</span><span class="token punctuation">(</span>birthday<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">theAddress</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> std<span class="token double-colon punctuation">::</span>string <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> std<span class="token double-colon punctuation">::</span>string <span class="token function">birthDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> std<span class="token double-colon punctuation">::</span>string <span class="token function">address</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    std<span class="token double-colon punctuation">::</span>string theName<span class="token punctuation">;</span>
    Date theBirthDate<span class="token punctuation">;</span>
    Address theAddress<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token comment">// å·¥å‚ç±»</span>
<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">static</span> std<span class="token double-colon punctuation">::</span>shared_ptr<span class="token operator">&lt;</span>Person<span class="token operator">></span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> name<span class="token punctuation">,</span>
        <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> birthday<span class="token punctuation">,</span> <span class="token keyword">const</span> Address<span class="token operator">&amp;</span> addr<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">shared_ptr</span><span class="token generic class-name"><span class="token operator">&lt;</span>Person<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">RealPerson</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> birthday<span class="token punctuation">,</span> addr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span></code></pre>
<p>ä»¥ä¸Šï¼Œé€šè¿‡Handle classå’ŒInterface classæ¥è§¦äº†æ¥å£å’Œå®ç°çš„è€¦åˆå…³ç³»ã€‚Handle classåˆ©ç”¨æ¥å£classå«æœ‰æŒ‡å‘å®ç°classçš„æŒ‡é’ˆæ¥è§¦æ¥å£å’Œå®ç°çš„è€¦åˆã€‚Interface classåˆ©ç”¨çº¯è™šå‡½æ•°æ¥å£ï¼Œå®ç°ç±»åªéœ€è¦å³æˆInterface classã€‚<br>ç¨‹åºå¤´æ–‡ä»¶åº”è¯¥ä»¥â€œå®Œå…¨ä¸”ä»…æœ‰å£°æ˜å¼â€çš„å½¢å¼å­˜åœ¨ã€‚</p>
</div></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/effective%20cpp/2021-2-20-6%E7%BB%A7%E6%89%BF%E5%92%8C%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B/" rel="prev" title="effectivecpp:ç»§æ‰¿"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">effectivecpp:ç»§æ‰¿</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/effective%20cpp/2021-02-09-4%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%A3%B0%E6%98%8E/" rel="next" title="effectivecpp:è®¾è®¡å’Œå£°æ˜"><span class="post-nav-text">effectivecpp:è®¾è®¡å’Œå£°æ˜</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>å¦‚æœæ‚¨æœ‰ä»»ä½•å…³äºåšå®¢å†…å®¹çš„ç›¸å…³è®¨è®ºï¼Œæ¬¢è¿å‰å¾€ <a href="https://github.com/YunYouJun/yunyoujun.github.io/discussions" target="_blank">GitHub Discussions</a> ä¸æˆ‘äº¤æµã€‚</span><br></div><div id="valine-container"></div><script>Yun.utils.getScript("https://cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js", () => {
  const valineConfig = {"enable":true,"appId":"K4LElSwpTJaHOOTTU6mNGCyr-gzGzoHsz","appKey":"x3d4Sv6rdTYOECKqkxg9r905","placeholder":"å¡«å†™é‚®ç®±ï¼Œå¯ä»¥æ”¶åˆ°å›å¤é€šçŸ¥å“¦ï½","avatar":null,"pageSize":10,"visitor":false,"highlight":true,"recordIP":false,"enableQQ":true,"meta":["nick","mail","link"],"el":"#valine-container","lang":"zh-cn"}
  valineConfig.path = "/effective%20cpp/2021-02-15-5%E5%AE%9E%E7%8E%B0/"
  new Valine(valineConfig)
}, window.Valine);</script></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank">èŒICPå¤‡666666å·</a></div><div class="copyright"><span>&copy; 2020 â€“ 2021 </span><a class="with-love" id="animate" target="_blank" rel="noopener" href="https://sponsors.yunyoujun.cn" title="äº‘æ¸¸å›çš„èµåŠ©è€…ä»¬"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></a><span class="author"> larry</span></div><div class="powered"><span>ç”± <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> é©±åŠ¨ v5.4.0</span><span class="footer-separator">|</span><span>ä¸»é¢˜ - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.6.3</span></div><div class="live_time"><span>æœ¬åšå®¢å·²èŒèŒå“’åœ°è¿è¡Œ</span><span id="display_live_time"></span><span class="moe-text">(â—'â—¡'â—)</span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2019-04-12T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " å¤© " + passHour + " å°æ—¶ " + passMinute + " åˆ† " + passSecond + " ç§’";
}
blog_live_time();
</script></div></footer><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#6200ee" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="æœç´¢"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script defer src="https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script><script defer src="https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script><script defer src="/js/search/algolia-search.js"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-close-line"></use></svg></span></div><div class="search-input-container"></div><div class="algolia-results"><div id="algolia-stats"></div><div id="algolia-hits"></div><div class="algolia-pagination" id="algolia-pagination"></div></div></div></div><!-- hexo injector body_end start --><script src="/js/tag-common/index.js"></script><!-- hexo injector body_end end --></body></html>